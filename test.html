<div class="markdown-reading-view" style="width: 100%; height: 100%; ;"><div class="markdown-preview-view markdown-rendered node-insert-event is-readable-line-width show-indentation-guide show-properties ascii" style="tab-size: 4;"><div class="markdown-preview-sizer markdown-preview-section rve-block-selector" style="padding-bottom: 360px; min-height: 659px;"><div class="markdown-preview-pusher" style="width: 1px; height: 0.1px; margin-bottom: 0px;"></div><div class="el-h1"><a name="docker-cheat-sheet-"></a><br><h1 data-heading="Docker Cheat Sheet üê≥" dir="auto" data-rve-block="true" tabindex="-1" class=""><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>Docker Cheat Sheet üê≥</h1></div><div class="el-hr"><hr></div><div class="el-pre"><div class="block-language-ascii"><div class="expressive-code"><figure class="frame"><figcaption class="header"></figcaption><pre data-language="ascii"><code><div class="ec-line"><div class="code"><span class="indent"><span style="color:#E1D6F8">                   </span></span><span style="color:#E1D6F8">##        .</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="color:#E1D6F8">             </span></span><span style="color:#E1D6F8">## ## ##       ==</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="color:#E1D6F8">          </span></span><span style="color:#E1D6F8">## ## ## ##      ===</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="color:#E1D6F8">      </span></span><span style="color:#E1D6F8">/""""""""""""""""\___/ ===</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="color:#E1D6F8"> </span></span><span style="color:#E1D6F8">~~~ {~~ ~~~~ ~~~ ~~~~ ~~ ~ /  ===- ~~~</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="color:#E1D6F8">      </span></span><span style="color:#E1D6F8">\______ o          __/</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="color:#E1D6F8">        </span></span><span style="color:#E1D6F8">\    \        __/</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="color:#E1D6F8">         </span></span><span style="color:#E1D6F8">\____\______/</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="                   ##        .             ## ## ##       ==          ## ## ## ##      ===      /&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;\___/ === ~~~ {~~ ~~~~ ~~~ ~~~~ ~~ ~ /  ===- ~~~      \______ o          __/        \    \        __/         \____\______/"><div></div></button></div></figure></div></div></div><div class="el-h3"><a name="background"></a><br><h3 data-heading="Background" dir="auto" data-rve-block="true" tabindex="-1"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>Background</h3></div><div class="el-p"><p dir="auto" data-rve-block="true" tabindex="-1">Docker is an open-source project that automates the deployment of software applications inside containers  by providing an additional layer of abstraction and automation of OS-level virtualization on Linux.</p></div><div class="el-p"><p dir="auto" data-rve-block="true" tabindex="-1">Docker is a tool that lets you run and deploy applications in a sandbox (container) on top of a host operating system (e.g. linux). It's key benefit is that it allows users to package an application  with all of its dependencies into a standardized unit for software development.</p></div><div class="el-p"><p dir="auto" data-rve-block="true" tabindex="-1">VMs run applications inside a guest Operating System, which runs on virtual hardware powered by the  server's host OS. VMs are great at providing full process isolation for applications, but the  computational overhead spent virtualizing hardware for a guest OS to use is substantial.</p></div><div class="el-p"><p dir="auto" data-rve-block="true" tabindex="-1">Containers take a different approach: by leveraging the low-level mechanics of the host OS,<br>
containers provide most of the isolation of virtual machines at a fraction of the computing power.</p></div><div class="el-hr"><hr></div><div class="el-h3"><a name="glossary"></a><br><h3 data-heading="Glossary" dir="auto" data-rve-block="true" tabindex="-1"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>Glossary</h3></div><div class="el-ul"><ul class="has-list-bullet">
<li data-line="0" dir="auto" data-rve-block="true" tabindex="-1"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span><strong>Registry</strong>
<ul class="has-list-bullet">
<li data-line="1" dir="auto" data-rve-block="true" tabindex="-1"><span class="list-bullet"></span>A hosted service containing repositories of images which responds to the Registry API.</li>
</ul>
</li>
<li data-line="2" dir="auto" data-rve-block="true" tabindex="-1"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span><strong>Container</strong>
<ul class="has-list-bullet">
<li data-line="3" dir="auto" data-rve-block="true" tabindex="-1"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>A a runtime instance of a docker image. Made of 3 components:
<ul class="has-list-bullet">
<li data-line="4" dir="auto" data-rve-block="true" tabindex="-1"><span class="list-bullet"></span>A Docker image</li>
<li data-line="5" dir="auto" data-rve-block="true" tabindex="-1"><span class="list-bullet"></span>An execution environment</li>
<li data-line="6" dir="auto" data-rve-block="true" tabindex="-1"><span class="list-bullet"></span>A standard set of instructions</li>
</ul>
</li>
</ul>
</li>
<li data-line="7" dir="auto" data-rve-block="true" tabindex="-1"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span><strong>Dockerfile</strong>
<ul class="has-list-bullet">
<li data-line="8" dir="auto" data-rve-block="true" tabindex="-1"><span class="list-bullet"></span>A text document that contains all the commands you would normally execute manually in order to build a Docker image. Docker can build images automatically by reading the instructions from a Dockerfile.</li>
</ul>
</li>
<li data-line="9" dir="auto" data-rve-block="true" tabindex="-1"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span><strong>Image</strong>
<ul class="has-list-bullet">
<li data-line="10" dir="auto" data-rve-block="true" tabindex="-1"><span class="list-bullet"></span>The basis of containers. An Image is an ordered collection of root filesystem changes and the corresponding execution parameters for use within a container runtime. An image typically contains a union of layered filesystems stacked on top of each other. An image does not have state and it never changes.</li>
</ul>
</li>
<li data-line="11" dir="auto" data-rve-block="true" tabindex="-1"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span><strong>Layer</strong>
<ul class="has-list-bullet">
<li data-line="12" dir="auto" data-rve-block="true" tabindex="-1"><span class="list-bullet"></span>In an image, a layer is modification to the image, represented by an instruction in the Dockerfile. Layers are applied in sequence to the base image to create the final image. When an image is updated or rebuilt, only layers that change need to be updated, and unchanged layers are cached locally. This is part of why Docker images are so fast and lightweight. The sizes of each layer add up to equal the size of the final image.</li>
</ul>
</li>
<li data-line="13" dir="auto" data-rve-block="true" tabindex="-1"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span><strong>Tag</strong>
<ul class="has-list-bullet">
<li data-line="14" dir="auto" data-rve-block="true" tabindex="-1"><span class="list-bullet"></span>A label applied to a Docker image in a repository. Tags are how various images in a repository are distinguished from each other.</li>
</ul>
</li>
<li data-line="15" dir="auto" data-rve-block="true" tabindex="-1"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span><strong>Build</strong>
<ul class="has-list-bullet">
<li data-line="16" dir="auto" data-rve-block="true" tabindex="-1"><span class="list-bullet"></span>The process of building Docker images using a Dockerfile. The build command uses a Dockerfile and a "context". The context is the set of files in the directory in which the image is built.</li>
</ul>
</li>
</ul></div><div class="el-hr"><hr></div><div class="el-h1"><a name="containers"></a><br><h1 data-heading="Containers" dir="auto" data-rve-block="true" tabindex="-1"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>Containers</h1></div><div class="el-p"><p dir="auto" data-rve-block="true" tabindex="-1"><a data-tooltip-position="top" aria-label="http://etherealmind.com/basics-docker-containers-hypervisors-coreos/" rel="noopener nofollow" class="external-link" href="http://etherealmind.com/basics-docker-containers-hypervisors-coreos/" target="_blank">Your basic isolated Docker process</a>. Containers are to Virtual Machines as threads are to processes. Or you can think of them as chroots on steroids.</p></div><div class="el-h3"><a name="lifecycle"></a><br><h3 data-heading="Lifecycle" dir="auto" data-rve-block="true" tabindex="-1"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>Lifecycle</h3></div><div class="el-ul"><ul class="has-list-bullet">
<li data-line="0" dir="auto" data-rve-block="true" tabindex="-1"><span class="list-bullet"></span><a data-tooltip-position="top" aria-label="https://docs.docker.com/engine/reference/commandline/create" rel="noopener nofollow" class="external-link" href="https://docs.docker.com/engine/reference/commandline/create" target="_blank"><code>docker create</code></a> creates a container but does not start it.</li>
<li data-line="1" dir="auto" data-rve-block="true" tabindex="-1"><span class="list-bullet"></span><a data-tooltip-position="top" aria-label="https://docs.docker.com/engine/reference/commandline/rename/" rel="noopener nofollow" class="external-link" href="https://docs.docker.com/engine/reference/commandline/rename/" target="_blank"><code>docker rename</code></a> allows the container to be renamed.</li>
<li data-line="2" dir="auto" data-rve-block="true" tabindex="-1"><span class="list-bullet"></span><a data-tooltip-position="top" aria-label="https://docs.docker.com/engine/reference/commandline/run" rel="noopener nofollow" class="external-link" href="https://docs.docker.com/engine/reference/commandline/run" target="_blank"><code>docker run</code></a> creates and starts a container in one operation.</li>
<li data-line="3" dir="auto" data-rve-block="true" tabindex="-1"><span class="list-bullet"></span><a data-tooltip-position="top" aria-label="https://docs.docker.com/engine/reference/commandline/rm" rel="noopener nofollow" class="external-link" href="https://docs.docker.com/engine/reference/commandline/rm" target="_blank"><code>docker rm</code></a> deletes a container.</li>
<li data-line="4" dir="auto" data-rve-block="true" tabindex="-1"><span class="list-bullet"></span><a data-tooltip-position="top" aria-label="https://docs.docker.com/engine/reference/commandline/update/" rel="noopener nofollow" class="external-link" href="https://docs.docker.com/engine/reference/commandline/update/" target="_blank"><code>docker update</code></a> updates a container's resource limits.</li>
</ul></div><div class="el-p"><p dir="auto" data-rve-block="true" tabindex="-1">Normally if you run a container without options it will start and stop immediately, if you want keep it running you can use the command, <code>docker run -td container_id</code> this will use the option <code>-t</code> that will allocate a pseudo-TTY session and <code>-d</code> that will detach automatically the container (run container in background and print container ID).</p></div><div class="el-p"><p dir="auto" data-rve-block="true" tabindex="-1">If you want a transient container, <code>docker run --rm</code> will remove the container after it stops.</p></div><div class="el-p"><p dir="auto" data-rve-block="true" tabindex="-1">If you want to map a directory on the host to a docker container, <code>docker run -v $HOSTDIR:$DOCKERDIR</code>. Also see <a data-tooltip-position="top" aria-label="https://github.com/wsargent/docker-cheat-sheet/#volumes" rel="noopener nofollow" class="external-link" href="https://github.com/wsargent/docker-cheat-sheet/#volumes" target="_blank">Volumes</a>.</p></div><div class="el-p"><p dir="auto" data-rve-block="true" tabindex="-1">If you want to remove also the volumes associated with the container, the deletion of the container must include the <code>-v</code> switch like in <code>docker rm -v</code>.</p></div><div class="el-p"><p dir="auto" data-rve-block="true" tabindex="-1">There's also a <a data-tooltip-position="top" aria-label="https://docs.docker.com/engine/admin/logging/overview/" rel="noopener nofollow" class="external-link" href="https://docs.docker.com/engine/admin/logging/overview/" target="_blank">logging driver</a> available for individual containers in docker 1.10. To run docker with a custom log driver (i.e., to syslog), use <code>docker run --log-driver=syslog</code>.</p></div><div class="el-p"><p dir="auto" data-rve-block="true" tabindex="-1">Another useful option is <code>docker run --name yourname docker_image</code> because when you specify the <code>--name</code> inside the run command this will allow you to start and stop a container by calling it with the name the you specified when you created it.</p></div><div class="el-h3"><a name="starting-and-stopping"></a><br><h3 data-heading="Starting and Stopping" dir="auto" data-rve-block="true" tabindex="-1"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>Starting and Stopping</h3></div><div class="el-ul"><ul class="has-list-bullet">
<li data-line="0" dir="auto" data-rve-block="true" tabindex="-1"><span class="list-bullet"></span><a data-tooltip-position="top" aria-label="https://docs.docker.com/engine/reference/commandline/start" rel="noopener nofollow" class="external-link" href="https://docs.docker.com/engine/reference/commandline/start" target="_blank"><code>docker start</code></a> starts a container so it is running.</li>
<li data-line="1" dir="auto" data-rve-block="true" tabindex="-1"><span class="list-bullet"></span><a data-tooltip-position="top" aria-label="https://docs.docker.com/engine/reference/commandline/stop" rel="noopener nofollow" class="external-link" href="https://docs.docker.com/engine/reference/commandline/stop" target="_blank"><code>docker stop</code></a> stops a running container.</li>
<li data-line="2" dir="auto" data-rve-block="true" tabindex="-1"><span class="list-bullet"></span><a data-tooltip-position="top" aria-label="https://docs.docker.com/engine/reference/commandline/restart" rel="noopener nofollow" class="external-link" href="https://docs.docker.com/engine/reference/commandline/restart" target="_blank"><code>docker restart</code></a> stops and starts a container.</li>
<li data-line="3" dir="auto" data-rve-block="true" tabindex="-1"><span class="list-bullet"></span><a data-tooltip-position="top" aria-label="https://docs.docker.com/engine/reference/commandline/pause/" rel="noopener nofollow" class="external-link" href="https://docs.docker.com/engine/reference/commandline/pause/" target="_blank"><code>docker pause</code></a> pauses a running container, "freezing" it in place.</li>
<li data-line="4" dir="auto" data-rve-block="true" tabindex="-1"><span class="list-bullet"></span><a data-tooltip-position="top" aria-label="https://docs.docker.com/engine/reference/commandline/unpause/" rel="noopener nofollow" class="external-link" href="https://docs.docker.com/engine/reference/commandline/unpause/" target="_blank"><code>docker unpause</code></a> will unpause a running container.</li>
<li data-line="5" dir="auto" data-rve-block="true" tabindex="-1"><span class="list-bullet"></span><a data-tooltip-position="top" aria-label="https://docs.docker.com/engine/reference/commandline/wait" rel="noopener nofollow" class="external-link" href="https://docs.docker.com/engine/reference/commandline/wait" target="_blank"><code>docker wait</code></a> blocks until running container stops.</li>
<li data-line="6" dir="auto" data-rve-block="true" tabindex="-1"><span class="list-bullet"></span><a data-tooltip-position="top" aria-label="https://docs.docker.com/engine/reference/commandline/kill" rel="noopener nofollow" class="external-link" href="https://docs.docker.com/engine/reference/commandline/kill" target="_blank"><code>docker kill</code></a> sends a SIGKILL to a running container.</li>
<li data-line="7" dir="auto" data-rve-block="true" tabindex="-1"><span class="list-bullet"></span><a data-tooltip-position="top" aria-label="https://docs.docker.com/engine/reference/commandline/attach" rel="noopener nofollow" class="external-link" href="https://docs.docker.com/engine/reference/commandline/attach" target="_blank"><code>docker attach</code></a> will connect to a running container.</li>
</ul></div><div class="el-p"><p dir="auto" data-rve-block="true" tabindex="-1">If you want to detach from a running container, use <code>Ctrl + p, Ctrl + q</code>.<br>
If you want to integrate a container with a <a data-tooltip-position="top" aria-label="https://docs.docker.com/engine/admin/host_integration/" rel="noopener nofollow" class="external-link" href="https://docs.docker.com/engine/admin/host_integration/" target="_blank">host process manager</a>, start the daemon with <code>-r=false</code> then use <code>docker start -a</code>.</p></div><div class="el-p"><p dir="auto" data-rve-block="true" tabindex="-1">If you want to expose container ports through the host, see the <a class="internal-link" data-href="#exposing-ports" href="#exposing-ports" target="_blank" rel="noopener nofollow">exposing ports</a> section.</p></div><div class="el-p"><p dir="auto" data-rve-block="true" tabindex="-1">Restart policies on crashed docker instances are <a data-tooltip-position="top" aria-label="http://container42.com/2014/09/30/docker-restart-policies/" rel="noopener nofollow" class="external-link" href="http://container42.com/2014/09/30/docker-restart-policies/" target="_blank">covered here</a>.</p></div><div class="el-h4"><a name="cpu-constraints"></a><br><h4 data-heading="CPU Constraints" dir="auto" data-rve-block="true" tabindex="-1"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>CPU Constraints</h4></div><div class="el-p"><p dir="auto" data-rve-block="true" tabindex="-1">You can limit CPU, either using a percentage of all CPUs, or by using specific cores.</p></div><div class="el-p"><p dir="auto" data-rve-block="true" tabindex="-1">For example, you can tell the <a data-tooltip-position="top" aria-label="https://docs.docker.com/engine/reference/run/#/cpu-share-constraint" rel="noopener nofollow" class="external-link" href="https://docs.docker.com/engine/reference/run/#/cpu-share-constraint" target="_blank"><code>cpu-shares</code></a> setting.  The setting is a bit strange -- 1024 means 100% of the CPU, so if you want the container to take 50% of all CPU cores, you should specify 512.  See <a rel="noopener nofollow" class="external-link" href="https://goldmann.pl/blog/2014/09/11/resource-management-in-docker/#_cpu" target="_blank">https://goldmann.pl/blog/2014/09/11/resource-management-in-docker/#_cpu</a> for more:</p></div><div class="el-pre"><div class="block-language-bash"><div class="expressive-code"><figure class="frame is-terminal"><figcaption class="header"><span class="title"></span><span class="sr-only">Terminal window</span></figcaption><pre data-language="bash"><code><div class="ec-line"><div class="code"><span style="color:#87FF5F">docker</span><span style="color:#BBBBBB"> </span><span style="color:#AB92FC">run</span><span style="color:#BBBBBB"> </span><span style="color:#8EDF5F">-it</span><span style="color:#BBBBBB"> </span><span style="color:#8EDF5F">-c</span><span style="color:#BBBBBB"> </span><span style="color:#87FF5F">512</span><span style="color:#BBBBBB"> </span><span style="color:#AB92FC">agileek/cpuset-test</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="docker run -it -c 512 agileek/cpuset-test"><div></div></button></div></figure></div></div></div><div class="el-p"><p dir="auto" data-rve-block="true" tabindex="-1">You can also only use some CPU cores using <a data-tooltip-position="top" aria-label="https://docs.docker.com/engine/reference/run/#/cpuset-constraint" rel="noopener nofollow" class="external-link" href="https://docs.docker.com/engine/reference/run/#/cpuset-constraint" target="_blank"><code>cpuset-cpus</code></a>.  See <a rel="noopener nofollow" class="external-link" href="https://agileek.github.io/docker/2014/08/06/docker-cpuset/" target="_blank">https://agileek.github.io/docker/2014/08/06/docker-cpuset/</a> for details and some nice videos:</p></div><div class="el-pre"><div class="block-language-bash"><div class="expressive-code"><figure class="frame is-terminal"><figcaption class="header"><span class="title"></span><span class="sr-only">Terminal window</span></figcaption><pre data-language="bash"><code><div class="ec-line"><div class="code"><span style="color:#87FF5F">docker</span><span style="color:#BBBBBB"> </span><span style="color:#AB92FC">run</span><span style="color:#BBBBBB"> </span><span style="color:#8EDF5F">-it</span><span style="color:#BBBBBB"> </span><span style="color:#8EDF5F">--cpuset-cpus=0,4,6</span><span style="color:#BBBBBB"> </span><span style="color:#AB92FC">agileek/cpuset-test</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="docker run -it --cpuset-cpus=0,4,6 agileek/cpuset-test"><div></div></button></div></figure></div></div></div><div class="el-p"><p dir="auto" data-rve-block="true" tabindex="-1">Note that Docker can still <strong>see</strong> all of the CPUs inside the container -- it just isn't using all of them.  See <a rel="noopener nofollow" class="external-link" href="https://github.com/docker/docker/issues/20770" target="_blank">https://github.com/docker/docker/issues/20770</a> for more details.</p></div><div class="el-h4"><a name="memory-constraints"></a><br><h4 data-heading="Memory Constraints" dir="auto" data-rve-block="true" tabindex="-1"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>Memory Constraints</h4></div><div class="el-p"><p dir="auto" data-rve-block="true" tabindex="-1">You can also set <a data-tooltip-position="top" aria-label="https://docs.docker.com/engine/reference/run/#/user-memory-constraints" rel="noopener nofollow" class="external-link" href="https://docs.docker.com/engine/reference/run/#/user-memory-constraints" target="_blank">memory constraints</a> on Docker:</p></div><div class="el-pre"><div class="block-language-bash"><div class="expressive-code"><figure class="frame is-terminal"><figcaption class="header"><span class="title"></span><span class="sr-only">Terminal window</span></figcaption><pre data-language="bash"><code><div class="ec-line"><div class="code"><span style="color:#87FF5F">docker</span><span style="color:#BBBBBB"> </span><span style="color:#AB92FC">run</span><span style="color:#BBBBBB"> </span><span style="color:#8EDF5F">-it</span><span style="color:#BBBBBB"> </span><span style="color:#8EDF5F">-m</span><span style="color:#BBBBBB"> </span><span style="color:#AB92FC">300M</span><span style="color:#BBBBBB"> </span><span style="color:#AB92FC">ubuntu:14.04</span><span style="color:#BBBBBB"> </span><span style="color:#AB92FC">/bin/bash</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="docker run -it -m 300M ubuntu:14.04 /bin/bash"><div></div></button></div></figure></div></div></div><div class="el-h4"><a name="capabilities"></a><br><h4 data-heading="Capabilities" dir="auto" data-rve-block="true" tabindex="-1"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>Capabilities</h4></div><div class="el-p"><p dir="auto" data-rve-block="true" tabindex="-1">Linux capabilities can be set by using <code>cap-add</code> and <code>cap-drop</code>.  See <a rel="noopener nofollow" class="external-link" href="https://docs.docker.com/engine/reference/run/#/runtime-privilege-and-linux-capabilities" target="_blank">https://docs.docker.com/engine/reference/run/#/runtime-privilege-and-linux-capabilities</a> for details.  This should be used for greater security.</p></div><div class="el-p"><p dir="auto" data-rve-block="true" tabindex="-1">To mount a FUSE based filesystem, you need to combine both --cap-add and --device:</p></div><div class="el-pre"><div class="block-language-bash"><div class="expressive-code"><figure class="frame is-terminal"><figcaption class="header"><span class="title"></span><span class="sr-only">Terminal window</span></figcaption><pre data-language="bash"><code><div class="ec-line"><div class="code"><span style="color:#87FF5F">docker</span><span style="color:#BBBBBB"> </span><span style="color:#AB92FC">run</span><span style="color:#BBBBBB"> </span><span style="color:#8EDF5F">--rm</span><span style="color:#BBBBBB"> </span><span style="color:#8EDF5F">-it</span><span style="color:#BBBBBB"> </span><span style="color:#8EDF5F">--cap-add</span><span style="color:#BBBBBB"> </span><span style="color:#AB92FC">SYS_ADMIN</span><span style="color:#BBBBBB"> </span><span style="color:#8EDF5F">--device</span><span style="color:#BBBBBB"> </span><span style="color:#AB92FC">/dev/fuse</span><span style="color:#BBBBBB"> </span><span style="color:#AB92FC">sshfs</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="docker run --rm -it --cap-add SYS_ADMIN --device /dev/fuse sshfs"><div></div></button></div></figure></div></div></div><div class="el-p"><p dir="auto" data-rve-block="true" tabindex="-1">Give access to a single device:</p></div><div class="el-pre"><div class="block-language-bash"><div class="expressive-code"><figure class="frame is-terminal"><figcaption class="header"><span class="title"></span><span class="sr-only">Terminal window</span></figcaption><pre data-language="bash"><code><div class="ec-line"><div class="code"><span style="color:#87FF5F">docker</span><span style="color:#BBBBBB"> </span><span style="color:#AB92FC">run</span><span style="color:#BBBBBB"> </span><span style="color:#8EDF5F">-it</span><span style="color:#BBBBBB"> </span><span style="color:#8EDF5F">--device=/dev/ttyUSB0</span><span style="color:#BBBBBB"> </span><span style="color:#AB92FC">debian</span><span style="color:#BBBBBB"> </span><span style="color:#AB92FC">bash</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="docker run -it --device=/dev/ttyUSB0 debian bash"><div></div></button></div></figure></div></div></div><div class="el-p"><p dir="auto" data-rve-block="true" tabindex="-1">Give access to all devices:</p></div><div class="el-pre"><div class="block-language-bash"><div class="expressive-code"><figure class="frame is-terminal"><figcaption class="header"><span class="title"></span><span class="sr-only">Terminal window</span></figcaption><pre data-language="bash"><code><div class="ec-line"><div class="code"><span style="color:#87FF5F">docker</span><span style="color:#BBBBBB"> </span><span style="color:#AB92FC">run</span><span style="color:#BBBBBB"> </span><span style="color:#8EDF5F">-it</span><span style="color:#BBBBBB"> </span><span style="color:#8EDF5F">--privileged</span><span style="color:#BBBBBB"> </span><span style="color:#8EDF5F">-v</span><span style="color:#BBBBBB"> </span><span style="color:#AB92FC">/dev/bus/usb:/dev/bus/usb</span><span style="color:#BBBBBB"> </span><span style="color:#AB92FC">debian</span><span style="color:#BBBBBB"> </span><span style="color:#AB92FC">bash</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="docker run -it --privileged -v /dev/bus/usb:/dev/bus/usb debian bash"><div></div></button></div></figure></div></div></div><div class="el-p"><p dir="auto" data-rve-block="true" tabindex="-1">More info about privileged containers <a data-tooltip-position="top" aria-label="https://docs.docker.com/engine/reference/run/#runtime-privilege-and-linux-capabilities" rel="noopener nofollow" class="external-link" href="https://docs.docker.com/engine/reference/run/#runtime-privilege-and-linux-capabilities" target="_blank">here</a>.</p></div><div class="el-h3"><a name="info"></a><br><h3 data-heading="Info" dir="auto" data-rve-block="true" tabindex="-1"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>Info</h3></div><div class="el-ul"><ul class="has-list-bullet">
<li data-line="0" dir="auto" data-rve-block="true" tabindex="-1"><span class="list-bullet"></span><a data-tooltip-position="top" aria-label="https://docs.docker.com/engine/reference/commandline/ps" rel="noopener nofollow" class="external-link" href="https://docs.docker.com/engine/reference/commandline/ps" target="_blank"><code>docker ps</code></a> shows running containers.</li>
<li data-line="1" dir="auto" data-rve-block="true" tabindex="-1"><span class="list-bullet"></span><a data-tooltip-position="top" aria-label="https://docs.docker.com/engine/reference/commandline/logs" rel="noopener nofollow" class="external-link" href="https://docs.docker.com/engine/reference/commandline/logs" target="_blank"><code>docker logs</code></a> gets logs from container.  (You can use a custom log driver, but logs is only available for <code>json-file</code> and <code>journald</code> in 1.10).</li>
<li data-line="2" dir="auto" data-rve-block="true" tabindex="-1"><span class="list-bullet"></span><a data-tooltip-position="top" aria-label="https://docs.docker.com/engine/reference/commandline/inspect" rel="noopener nofollow" class="external-link" href="https://docs.docker.com/engine/reference/commandline/inspect" target="_blank"><code>docker inspect</code></a> looks at all the info on a container (including IP address).</li>
<li data-line="3" dir="auto" data-rve-block="true" tabindex="-1"><span class="list-bullet"></span><a data-tooltip-position="top" aria-label="https://docs.docker.com/engine/reference/commandline/events" rel="noopener nofollow" class="external-link" href="https://docs.docker.com/engine/reference/commandline/events" target="_blank"><code>docker events</code></a> gets events from container.</li>
<li data-line="4" dir="auto" data-rve-block="true" tabindex="-1"><span class="list-bullet"></span><a data-tooltip-position="top" aria-label="https://docs.docker.com/engine/reference/commandline/port" rel="noopener nofollow" class="external-link" href="https://docs.docker.com/engine/reference/commandline/port" target="_blank"><code>docker port</code></a> shows public facing port of container.</li>
<li data-line="5" dir="auto" data-rve-block="true" tabindex="-1"><span class="list-bullet"></span><a data-tooltip-position="top" aria-label="https://docs.docker.com/engine/reference/commandline/top" rel="noopener nofollow" class="external-link" href="https://docs.docker.com/engine/reference/commandline/top" target="_blank"><code>docker top</code></a> shows running processes in container.</li>
<li data-line="6" dir="auto" data-rve-block="true" tabindex="-1"><span class="list-bullet"></span><a data-tooltip-position="top" aria-label="https://docs.docker.com/engine/reference/commandline/stats" rel="noopener nofollow" class="external-link" href="https://docs.docker.com/engine/reference/commandline/stats" target="_blank"><code>docker stats</code></a> shows containers' resource usage statistics.</li>
<li data-line="7" dir="auto" data-rve-block="true" tabindex="-1"><span class="list-bullet"></span><a data-tooltip-position="top" aria-label="https://docs.docker.com/engine/reference/commandline/diff" rel="noopener nofollow" class="external-link" href="https://docs.docker.com/engine/reference/commandline/diff" target="_blank"><code>docker diff</code></a> shows changed files in the container's FS.</li>
</ul></div><div class="el-p"><p dir="auto" data-rve-block="true" tabindex="-1"><code>docker ps -a</code> shows running and stopped containers.</p></div><div class="el-p"><p dir="auto" data-rve-block="true" tabindex="-1"><code>docker stats --all</code> shows a list of all containers, default shows just running.</p></div><div class="el-h3"><a name="import-export"></a><br><h3 data-heading="Import / Export" dir="auto" data-rve-block="true" tabindex="-1"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>Import / Export</h3></div><div class="el-ul"><ul class="has-list-bullet">
<li data-line="0" dir="auto" data-rve-block="true" tabindex="-1"><span class="list-bullet"></span><a data-tooltip-position="top" aria-label="https://docs.docker.com/engine/reference/commandline/cp" rel="noopener nofollow" class="external-link" href="https://docs.docker.com/engine/reference/commandline/cp" target="_blank"><code>docker cp</code></a> copies files or folders between a container and the local filesystem.</li>
<li data-line="1" dir="auto" data-rve-block="true" tabindex="-1"><span class="list-bullet"></span><a data-tooltip-position="top" aria-label="https://docs.docker.com/engine/reference/commandline/export" rel="noopener nofollow" class="external-link" href="https://docs.docker.com/engine/reference/commandline/export" target="_blank"><code>docker export</code></a> turns container filesystem into tarball archive stream to STDOUT.</li>
</ul></div><div class="el-h3"><a name="executing-commands"></a><br><h3 data-heading="Executing Commands" dir="auto" data-rve-block="true" tabindex="-1"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>Executing Commands</h3></div><div class="el-ul"><ul class="has-list-bullet">
<li data-line="0" dir="auto" data-rve-block="true" tabindex="-1"><span class="list-bullet"></span><a data-tooltip-position="top" aria-label="https://docs.docker.com/engine/reference/commandline/exec" rel="noopener nofollow" class="external-link" href="https://docs.docker.com/engine/reference/commandline/exec" target="_blank"><code>docker exec</code></a> to execute a command in container.</li>
</ul></div><div class="el-p"><p dir="auto" data-rve-block="true" tabindex="-1">To enter a running container, attach a new shell process to a running container called foo, use: <code>docker exec -it foo /bin/bash</code>.</p></div><div class="el-hr"><hr></div><div class="el-h1"><a name="images"></a><br><h1 data-heading="Images" dir="auto" data-rve-block="true" tabindex="-1"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>Images</h1></div><div class="el-p"><p dir="auto" data-rve-block="true" tabindex="-1">Images are just <a data-tooltip-position="top" aria-label="https://docs.docker.com/engine/understanding-docker/#how-does-a-docker-image-work" rel="noopener nofollow" class="external-link" href="https://docs.docker.com/engine/understanding-docker/#how-does-a-docker-image-work" target="_blank">templates for docker containers</a>.</p></div><div class="el-h3"><a name="lifecycle"></a><br><h3 data-heading="Lifecycle" dir="auto" data-rve-block="true" tabindex="-1"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>Lifecycle</h3></div><div class="el-ul"><ul class="has-list-bullet">
<li data-line="0" dir="auto" data-rve-block="true" tabindex="-1"><span class="list-bullet"></span><a data-tooltip-position="top" aria-label="https://docs.docker.com/engine/reference/commandline/images" rel="noopener nofollow" class="external-link" href="https://docs.docker.com/engine/reference/commandline/images" target="_blank"><code>docker images</code></a> shows all images.</li>
<li data-line="1" dir="auto" data-rve-block="true" tabindex="-1"><span class="list-bullet"></span><a data-tooltip-position="top" aria-label="https://docs.docker.com/engine/reference/commandline/import" rel="noopener nofollow" class="external-link" href="https://docs.docker.com/engine/reference/commandline/import" target="_blank"><code>docker import</code></a> creates an image from a tarball.</li>
<li data-line="2" dir="auto" data-rve-block="true" tabindex="-1"><span class="list-bullet"></span><a data-tooltip-position="top" aria-label="https://docs.docker.com/engine/reference/commandline/build" rel="noopener nofollow" class="external-link" href="https://docs.docker.com/engine/reference/commandline/build" target="_blank"><code>docker build</code></a> creates image from Dockerfile.</li>
<li data-line="3" dir="auto" data-rve-block="true" tabindex="-1"><span class="list-bullet"></span><a data-tooltip-position="top" aria-label="https://docs.docker.com/engine/reference/commandline/commit" rel="noopener nofollow" class="external-link" href="https://docs.docker.com/engine/reference/commandline/commit" target="_blank"><code>docker commit</code></a> creates image from a container, pausing it temporarily if it is running.</li>
<li data-line="4" dir="auto" data-rve-block="true" tabindex="-1"><span class="list-bullet"></span><a data-tooltip-position="top" aria-label="https://docs.docker.com/engine/reference/commandline/rmi" rel="noopener nofollow" class="external-link" href="https://docs.docker.com/engine/reference/commandline/rmi" target="_blank"><code>docker rmi</code></a> removes an image.</li>
<li data-line="5" dir="auto" data-rve-block="true" tabindex="-1"><span class="list-bullet"></span><a data-tooltip-position="top" aria-label="https://docs.docker.com/engine/reference/commandline/load" rel="noopener nofollow" class="external-link" href="https://docs.docker.com/engine/reference/commandline/load" target="_blank"><code>docker load</code></a> loads an image from a tar archive as STDIN, including images and tags (as of 0.7).</li>
<li data-line="6" dir="auto" data-rve-block="true" tabindex="-1"><span class="list-bullet"></span><a data-tooltip-position="top" aria-label="https://docs.docker.com/engine/reference/commandline/save" rel="noopener nofollow" class="external-link" href="https://docs.docker.com/engine/reference/commandline/save" target="_blank"><code>docker save</code></a> saves an image to a tar archive stream to STDOUT with all parent layers, tags &amp; versions (as of 0.7).</li>
</ul></div><div class="el-h3"><a name="info"></a><br><h3 data-heading="Info" dir="auto" data-rve-block="true" tabindex="-1"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>Info</h3></div><div class="el-ul"><ul class="has-list-bullet">
<li data-line="0" dir="auto" data-rve-block="true" tabindex="-1"><span class="list-bullet"></span><a data-tooltip-position="top" aria-label="https://docs.docker.com/engine/reference/commandline/history" rel="noopener nofollow" class="external-link" href="https://docs.docker.com/engine/reference/commandline/history" target="_blank"><code>docker history</code></a> shows history of image.</li>
<li data-line="1" dir="auto" data-rve-block="true" tabindex="-1"><span class="list-bullet"></span><a data-tooltip-position="top" aria-label="https://docs.docker.com/engine/reference/commandline/tag" rel="noopener nofollow" class="external-link" href="https://docs.docker.com/engine/reference/commandline/tag" target="_blank"><code>docker tag</code></a> tags an image to a name (local or registry).</li>
</ul></div><div class="el-h3"><a name="cleaning-up"></a><br><h3 data-heading="Cleaning up" dir="auto" data-rve-block="true" tabindex="-1"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>Cleaning up</h3></div><div class="el-p"><p dir="auto" data-rve-block="true" tabindex="-1">While you can use the <code>docker rmi</code> command to remove specific images, there's a tool called <a data-tooltip-position="top" aria-label="https://github.com/spotify/docker-gc" rel="noopener nofollow" class="external-link" href="https://github.com/spotify/docker-gc" target="_blank">docker-gc</a> that will safely clean up images that are no longer used by any containers. As of docker 1.13, <code>docker image prune</code> is also available for removing unused images. See <a class="internal-link" data-href="#prune" href="#prune" target="_blank" rel="noopener nofollow">Prune</a>.</p></div><div class="el-h3"><a name="load-save-image"></a><br><h3 data-heading="Load/Save image" dir="auto" data-rve-block="true" tabindex="-1"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>Load/Save image</h3></div><div class="el-p"><p dir="auto" data-rve-block="true" tabindex="-1">Load an image from file:</p></div><div class="el-pre"><div class="block-language-bash"><div class="expressive-code"><figure class="frame is-terminal"><figcaption class="header"><span class="title"></span><span class="sr-only">Terminal window</span></figcaption><pre data-language="bash"><code><div class="ec-line"><div class="code"><span style="color:#87FF5F">docker</span><span style="color:#BBBBBB"> </span><span style="color:#AB92FC">load</span><span style="color:#BBBBBB"> </span><span style="color:#B968FC">&lt;</span><span style="color:#BBBBBB"> </span><span style="color:#AB92FC">my_image.tar.gz</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="docker load < my_image.tar.gz"><div></div></button></div></figure></div></div></div><div class="el-p"><p dir="auto" data-rve-block="true" tabindex="-1">Save an existing image:</p></div><div class="el-pre"><div class="block-language-bash"><div class="expressive-code"><figure class="frame is-terminal"><figcaption class="header"><span class="title"></span><span class="sr-only">Terminal window</span></figcaption><pre data-language="bash"><code><div class="ec-line"><div class="code"><span style="color:#87FF5F">docker</span><span style="color:#BBBBBB"> </span><span style="color:#AB92FC">save</span><span style="color:#BBBBBB"> </span><span style="color:#AB92FC">my_image:my_tag</span><span style="color:#BBBBBB"> </span><span style="color:#B968FC">|</span><span style="color:#BBBBBB"> </span><span style="color:#87FF5F">gzip</span><span style="color:#BBBBBB"> </span><span style="color:#B968FC">&gt;</span><span style="color:#BBBBBB"> </span><span style="color:#AB92FC">my_image.tar.gz</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="docker save my_image:my_tag | gzip > my_image.tar.gz"><div></div></button></div></figure></div></div></div><div class="el-h3"><a name="import-export-container"></a><br><h3 data-heading="Import/Export container" dir="auto" data-rve-block="true" tabindex="-1"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>Import/Export container</h3></div><div class="el-p"><p dir="auto" data-rve-block="true" tabindex="-1">Import a container as an image from file:</p></div><div class="el-pre"><div class="block-language-bash"><div class="expressive-code"><figure class="frame is-terminal"><figcaption class="header"><span class="title"></span><span class="sr-only">Terminal window</span></figcaption><pre data-language="bash"><code><div class="ec-line"><div class="code"><span style="color:#87FF5F">cat</span><span style="color:#BBBBBB"> </span><span style="color:#AB92FC">my_container.tar.gz</span><span style="color:#BBBBBB"> </span><span style="color:#B968FC">|</span><span style="color:#BBBBBB"> </span><span style="color:#87FF5F">docker</span><span style="color:#BBBBBB"> </span><span style="color:#AB92FC">import</span><span style="color:#BBBBBB"> </span><span style="color:#AB92FC">-</span><span style="color:#BBBBBB"> </span><span style="color:#AB92FC">my_image:my_tag</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="cat my_container.tar.gz | docker import - my_image:my_tag"><div></div></button></div></figure></div></div></div><div class="el-p"><p dir="auto" data-rve-block="true" tabindex="-1">Export an existing container:</p></div><div class="el-pre"><div class="block-language-bash"><div class="expressive-code"><figure class="frame is-terminal"><figcaption class="header"><span class="title"></span><span class="sr-only">Terminal window</span></figcaption><pre data-language="bash"><code><div class="ec-line"><div class="code"><span style="color:#87FF5F">docker</span><span style="color:#BBBBBB"> </span><span style="color:#AB92FC">export</span><span style="color:#BBBBBB"> </span><span style="color:#AB92FC">my_container</span><span style="color:#BBBBBB"> </span><span style="color:#B968FC">|</span><span style="color:#BBBBBB"> </span><span style="color:#87FF5F">gzip</span><span style="color:#BBBBBB"> </span><span style="color:#B968FC">&gt;</span><span style="color:#BBBBBB"> </span><span style="color:#AB92FC">my_container.tar.gz</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="docker export my_container | gzip > my_container.tar.gz"><div></div></button></div></figure></div></div></div><div class="el-h3"><a name="difference-between-loading-a-saved-image-and-importing-an-exported-container-as-an-image"></a><br><h3 data-heading="Difference between loading a saved image and importing an exported container as an image" dir="auto" data-rve-block="true" tabindex="-1"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>Difference between loading a saved image and importing an exported container as an image</h3></div><div class="el-p"><p dir="auto" data-rve-block="true" tabindex="-1">Loading an image using the <code>load</code> command creates a new image including its history.<br>
Importing a container as an image using the <code>import</code> command creates a new image excluding the history which results in a smaller image size compared to loading an image.</p></div><div class="el-hr"><hr></div><div class="el-h1"><a name="networks"></a><br><h1 data-heading="Networks" dir="auto" data-rve-block="true" tabindex="-1"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>Networks</h1></div><div class="el-p"><p dir="auto" data-rve-block="true" tabindex="-1">Docker has a <a data-tooltip-position="top" aria-label="https://docs.docker.com/engine/userguide/networking/" rel="noopener nofollow" class="external-link" href="https://docs.docker.com/engine/userguide/networking/" target="_blank">networks</a> feature. Docker automatically creates 3 network interfaces when you install it (bridge, host none). A new container is launched into the bridge network by default. To enable communication between multiple containers, you can create a new network and launch containers in it. This enables containers to communicate to each other while being isolated from containers that are not connected to the network. Furthermore, it allows to map container names to their IP addresses. See <a data-tooltip-position="top" aria-label="https://docs.docker.com/engine/userguide/networking/work-with-networks/" rel="noopener nofollow" class="external-link" href="https://docs.docker.com/engine/userguide/networking/work-with-networks/" target="_blank">working with networks</a> for more details.</p></div><div class="el-h3"><a name="lifecycle"></a><br><h3 data-heading="Lifecycle" dir="auto" data-rve-block="true" tabindex="-1"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>Lifecycle</h3></div><div class="el-ul"><ul class="has-list-bullet">
<li data-line="0" dir="auto" data-rve-block="true" tabindex="-1"><span class="list-bullet"></span><a data-tooltip-position="top" aria-label="https://docs.docker.com/engine/reference/commandline/network_create/" rel="noopener nofollow" class="external-link" href="https://docs.docker.com/engine/reference/commandline/network_create/" target="_blank"><code>docker network create</code></a> NAME Create a new network (default type: bridge).</li>
<li data-line="1" dir="auto" data-rve-block="true" tabindex="-1"><span class="list-bullet"></span><a data-tooltip-position="top" aria-label="https://docs.docker.com/engine/reference/commandline/network_rm/" rel="noopener nofollow" class="external-link" href="https://docs.docker.com/engine/reference/commandline/network_rm/" target="_blank"><code>docker network rm</code></a> NAME Remove one or more networks by name or identifier. No containers can be connected to the network when deleting it.</li>
</ul></div><div class="el-h3"><a name="info"></a><br><h3 data-heading="Info" dir="auto" data-rve-block="true" tabindex="-1"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>Info</h3></div><div class="el-ul"><ul class="has-list-bullet">
<li data-line="0" dir="auto" data-rve-block="true" tabindex="-1"><span class="list-bullet"></span><a data-tooltip-position="top" aria-label="https://docs.docker.com/engine/reference/commandline/network_ls/" rel="noopener nofollow" class="external-link" href="https://docs.docker.com/engine/reference/commandline/network_ls/" target="_blank"><code>docker network ls</code></a> List networks</li>
<li data-line="1" dir="auto" data-rve-block="true" tabindex="-1"><span class="list-bullet"></span><a data-tooltip-position="top" aria-label="https://docs.docker.com/engine/reference/commandline/network_inspect/" rel="noopener nofollow" class="external-link" href="https://docs.docker.com/engine/reference/commandline/network_inspect/" target="_blank"><code>docker network inspect</code></a> NAME Display detailed information on one or more networks.</li>
</ul></div><div class="el-h3"><a name="connection"></a><br><h3 data-heading="Connection" dir="auto" data-rve-block="true" tabindex="-1"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>Connection</h3></div><div class="el-ul"><ul class="has-list-bullet">
<li data-line="0" dir="auto" data-rve-block="true" tabindex="-1"><span class="list-bullet"></span><a data-tooltip-position="top" aria-label="https://docs.docker.com/engine/reference/commandline/network_connect/" rel="noopener nofollow" class="external-link" href="https://docs.docker.com/engine/reference/commandline/network_connect/" target="_blank"><code>docker network connect</code></a> NETWORK CONTAINER Connect a container to a network</li>
<li data-line="1" dir="auto" data-rve-block="true" tabindex="-1"><span class="list-bullet"></span><a data-tooltip-position="top" aria-label="https://docs.docker.com/engine/reference/commandline/network_disconnect/" rel="noopener nofollow" class="external-link" href="https://docs.docker.com/engine/reference/commandline/network_disconnect/" target="_blank"><code>docker network disconnect</code></a> NETWORK CONTAINER Disconnect a container from a network</li>
</ul></div><div class="el-p"><p dir="auto" data-rve-block="true" tabindex="-1">You can specify a <a data-tooltip-position="top" aria-label="https://blog.jessfraz.com/post/ips-for-all-the-things/" rel="noopener nofollow" class="external-link" href="https://blog.jessfraz.com/post/ips-for-all-the-things/" target="_blank">specific IP address for a container</a>:</p></div><div class="el-pre"><div class="block-language-bash"><div class="expressive-code"><figure class="frame is-terminal"><figcaption class="header"><span class="title"></span><span class="sr-only">Terminal window</span></figcaption><pre data-language="bash"><code><div class="ec-line"><div class="code"><span style="color:#A1A0AD"># create a new bridge network with your subnet and gateway for your ip block</span></div></div><div class="ec-line"><div class="code"><span style="color:#87FF5F">docker</span><span style="color:#BBBBBB"> </span><span style="color:#AB92FC">network</span><span style="color:#BBBBBB"> </span><span style="color:#AB92FC">create</span><span style="color:#BBBBBB"> </span><span style="color:#8EDF5F">--subnet</span><span style="color:#BBBBBB"> </span><span style="color:#AB92FC">203.0.113.0/24</span><span style="color:#BBBBBB"> </span><span style="color:#8EDF5F">--gateway</span><span style="color:#BBBBBB"> </span><span style="color:#87FF5F">203.0.113.254</span><span style="color:#BBBBBB"> </span><span style="color:#AB92FC">iptastic</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="color:#A1A0AD"># run a nginx container with a specific ip in that block</span></div></div><div class="ec-line"><div class="code"><span style="color:#87FF5F">$</span><span style="color:#BBBBBB"> </span><span style="color:#AB92FC">docker</span><span style="color:#BBBBBB"> </span><span style="color:#AB92FC">run</span><span style="color:#BBBBBB"> </span><span style="color:#8EDF5F">--rm</span><span style="color:#BBBBBB"> </span><span style="color:#8EDF5F">-it</span><span style="color:#BBBBBB"> </span><span style="color:#8EDF5F">--net</span><span style="color:#BBBBBB"> </span><span style="color:#AB92FC">iptastic</span><span style="color:#BBBBBB"> </span><span style="color:#8EDF5F">--ip</span><span style="color:#BBBBBB"> </span><span style="color:#87FF5F">203.0.113.2</span><span style="color:#BBBBBB"> </span><span style="color:#AB92FC">nginx</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="color:#A1A0AD"># curl the ip from any other place (assuming this is a public ip block duh)</span></div></div><div class="ec-line"><div class="code"><span style="color:#87FF5F">$</span><span style="color:#BBBBBB"> </span><span style="color:#AB92FC">curl</span><span style="color:#BBBBBB"> </span><span style="color:#87FF5F">203.0.113.2</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="docker network create --subnet 203.0.113.0/24 --gateway 203.0.113.254 iptastic$ docker run --rm -it --net iptastic --ip 203.0.113.2 nginx$ curl 203.0.113.2"><div></div></button></div></figure></div></div></div><div class="el-hr"><hr></div><div class="el-h1"><a name="registry-amp-repository"></a><br><h1 data-heading="Registry &amp; Repository" dir="auto" data-rve-block="true" tabindex="-1"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>Registry &amp; Repository</h1></div><div class="el-p"><p dir="auto" data-rve-block="true" tabindex="-1">A repository is a <em>hosted</em> collection of tagged images that together create the file system for a container.</p></div><div class="el-p"><p dir="auto" data-rve-block="true" tabindex="-1">A registry is a <em>host</em> -- a server that stores repositories and provides an HTTP API for <a data-tooltip-position="top" aria-label="https://docs.docker.com/engine/tutorials/dockerrepos/" rel="noopener nofollow" class="external-link" href="https://docs.docker.com/engine/tutorials/dockerrepos/" target="_blank">managing the uploading and downloading of repositories</a>.</p></div><div class="el-p"><p dir="auto" data-rve-block="true" tabindex="-1">Docker.com hosts its own <a data-tooltip-position="top" aria-label="https://hub.docker.com/" rel="noopener nofollow" class="external-link" href="https://hub.docker.com/" target="_blank">index</a> to a central registry which contains a large number of repositories.  Having said that, the central docker registry <a data-tooltip-position="top" aria-label="https://titanous.com/posts/docker-insecurity" rel="noopener nofollow" class="external-link" href="https://titanous.com/posts/docker-insecurity" target="_blank">does not do a good job of verifying images</a> and should be avoided if you're worried about security.</p></div><div class="el-ul"><ul class="has-list-bullet">
<li data-line="0" dir="auto" data-rve-block="true" tabindex="-1"><span class="list-bullet"></span><a data-tooltip-position="top" aria-label="https://docs.docker.com/engine/reference/commandline/login" rel="noopener nofollow" class="external-link" href="https://docs.docker.com/engine/reference/commandline/login" target="_blank"><code>docker login</code></a> to login to a registry.</li>
<li data-line="1" dir="auto" data-rve-block="true" tabindex="-1"><span class="list-bullet"></span><a data-tooltip-position="top" aria-label="https://docs.docker.com/engine/reference/commandline/logout" rel="noopener nofollow" class="external-link" href="https://docs.docker.com/engine/reference/commandline/logout" target="_blank"><code>docker logout</code></a> to logout from a registry.</li>
<li data-line="2" dir="auto" data-rve-block="true" tabindex="-1"><span class="list-bullet"></span><a data-tooltip-position="top" aria-label="https://docs.docker.com/engine/reference/commandline/search" rel="noopener nofollow" class="external-link" href="https://docs.docker.com/engine/reference/commandline/search" target="_blank"><code>docker search</code></a> searches registry for image.</li>
<li data-line="3" dir="auto" data-rve-block="true" tabindex="-1"><span class="list-bullet"></span><a data-tooltip-position="top" aria-label="https://docs.docker.com/engine/reference/commandline/pull" rel="noopener nofollow" class="external-link" href="https://docs.docker.com/engine/reference/commandline/pull" target="_blank"><code>docker pull</code></a> pulls an image from registry to local machine.</li>
<li data-line="4" dir="auto" data-rve-block="true" tabindex="-1"><span class="list-bullet"></span><a data-tooltip-position="top" aria-label="https://docs.docker.com/engine/reference/commandline/push" rel="noopener nofollow" class="external-link" href="https://docs.docker.com/engine/reference/commandline/push" target="_blank"><code>docker push</code></a> pushes an image to the registry from local machine.</li>
</ul></div><div class="el-h3"><a name="run-local-registry"></a><br><h3 data-heading="Run local registry" dir="auto" data-rve-block="true" tabindex="-1"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>Run local registry</h3></div><div class="el-p"><p dir="auto" data-rve-block="true" tabindex="-1">You can run a local registry by using the <a data-tooltip-position="top" aria-label="https://github.com/docker/distribution" rel="noopener nofollow" class="external-link" href="https://github.com/docker/distribution" target="_blank">docker distribution</a> project and looking at the <a data-tooltip-position="top" aria-label="https://github.com/docker/docker.github.io/blob/master/registry/deploying.md" rel="noopener nofollow" class="external-link" href="https://github.com/docker/docker.github.io/blob/master/registry/deploying.md" target="_blank">local deploy</a> instructions.</p></div><div class="el-p"><p dir="auto" data-rve-block="true" tabindex="-1">Also see the <a data-tooltip-position="top" aria-label="https://groups.google.com/a/dockerproject.org/forum/#!forum/distribution" rel="noopener nofollow" class="external-link" href="https://groups.google.com/a/dockerproject.org/forum/#!forum/distribution" target="_blank">mailing list</a>.</p></div><div class="el-hr"><hr></div><div class="el-h1"><a name="dockerfile"></a><br><h1 data-heading="Dockerfile" dir="auto" data-rve-block="true" tabindex="-1"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>Dockerfile</h1></div><div class="el-p"><p dir="auto" data-rve-block="true" tabindex="-1"><a data-tooltip-position="top" aria-label="https://docs.docker.com/engine/reference/builder/" rel="noopener nofollow" class="external-link" href="https://docs.docker.com/engine/reference/builder/" target="_blank">The configuration file</a>. Sets up a Docker container when you run <code>docker build</code> on it. Vastly preferable to <code>docker commit</code>.</p></div><div class="el-p"><p dir="auto" data-rve-block="true" tabindex="-1">Here are some common text editors and their syntax highlighting modules you could use to create Dockerfiles:</p></div><div class="el-ul"><ul class="has-list-bullet">
<li data-line="0" dir="auto" data-rve-block="true" tabindex="-1"><span class="list-bullet"></span>If you use <a data-tooltip-position="top" aria-label="http://jedit.org" rel="noopener nofollow" class="external-link" href="http://jedit.org" target="_blank">jEdit</a>, I've put up a syntax highlighting module for <a data-tooltip-position="top" aria-label="https://github.com/wsargent/jedit-docker-mode" rel="noopener nofollow" class="external-link" href="https://github.com/wsargent/jedit-docker-mode" target="_blank">Dockerfile</a> you can use.</li>
<li data-line="1" dir="auto" data-rve-block="true" tabindex="-1"><span class="list-bullet"></span><a data-tooltip-position="top" aria-label="https://packagecontrol.io/packages/Dockerfile%20Syntax%20Highlighting" rel="noopener nofollow" class="external-link" href="https://packagecontrol.io/packages/Dockerfile%20Syntax%20Highlighting" target="_blank">Sublime Text 2</a></li>
<li data-line="2" dir="auto" data-rve-block="true" tabindex="-1"><span class="list-bullet"></span><a data-tooltip-position="top" aria-label="https://atom.io/packages/language-docker" rel="noopener nofollow" class="external-link" href="https://atom.io/packages/language-docker" target="_blank">Atom</a></li>
<li data-line="3" dir="auto" data-rve-block="true" tabindex="-1"><span class="list-bullet"></span><a data-tooltip-position="top" aria-label="https://github.com/ekalinin/Dockerfile.vim" rel="noopener nofollow" class="external-link" href="https://github.com/ekalinin/Dockerfile.vim" target="_blank">Vim</a></li>
<li data-line="4" dir="auto" data-rve-block="true" tabindex="-1"><span class="list-bullet"></span><a data-tooltip-position="top" aria-label="https://github.com/spotify/dockerfile-mode" rel="noopener nofollow" class="external-link" href="https://github.com/spotify/dockerfile-mode" target="_blank">Emacs</a></li>
<li data-line="5" dir="auto" data-rve-block="true" tabindex="-1"><span class="list-bullet"></span><a data-tooltip-position="top" aria-label="https://github.com/docker/docker/tree/master/contrib/syntax/textmate" rel="noopener nofollow" class="external-link" href="https://github.com/docker/docker/tree/master/contrib/syntax/textmate" target="_blank">TextMate</a></li>
<li data-line="6" dir="auto" data-rve-block="true" tabindex="-1"><span class="list-bullet"></span><a data-tooltip-position="top" aria-label="https://github.com/Microsoft/vscode-docker" rel="noopener nofollow" class="external-link" href="https://github.com/Microsoft/vscode-docker" target="_blank">VS Code</a></li>
<li data-line="7" dir="auto" data-rve-block="true" tabindex="-1"><span class="list-bullet"></span>Also see <a data-tooltip-position="top" aria-label="https://domeide.github.io/" rel="noopener nofollow" class="external-link" href="https://domeide.github.io/" target="_blank">Docker meets the IDE</a></li>
</ul></div><div class="el-h3"><a name="instructions"></a><br><h3 data-heading="Instructions" dir="auto" data-rve-block="true" tabindex="-1"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>Instructions</h3></div><div class="el-ul"><ul class="has-list-bullet">
<li data-line="0" dir="auto" data-rve-block="true" tabindex="-1"><span class="list-bullet"></span><a data-tooltip-position="top" aria-label="https://docs.docker.com/engine/reference/builder/#dockerignore-file" rel="noopener nofollow" class="external-link" href="https://docs.docker.com/engine/reference/builder/#dockerignore-file" target="_blank">.dockerignore</a></li>
<li data-line="1" dir="auto" data-rve-block="true" tabindex="-1"><span class="list-bullet"></span><a data-tooltip-position="top" aria-label="https://docs.docker.com/engine/reference/builder/#from" rel="noopener nofollow" class="external-link" href="https://docs.docker.com/engine/reference/builder/#from" target="_blank">FROM</a> Sets the Base Image for subsequent instructions.</li>
<li data-line="2" dir="auto" data-rve-block="true" tabindex="-1"><span class="list-bullet"></span><a data-tooltip-position="top" aria-label="https://docs.docker.com/engine/reference/builder/#maintainer-deprecated" rel="noopener nofollow" class="external-link" href="https://docs.docker.com/engine/reference/builder/#maintainer-deprecated" target="_blank">MAINTAINER (deprecated - use LABEL instead)</a> Set the Author field of the generated images.</li>
<li data-line="3" dir="auto" data-rve-block="true" tabindex="-1"><span class="list-bullet"></span><a data-tooltip-position="top" aria-label="https://docs.docker.com/engine/reference/builder/#run" rel="noopener nofollow" class="external-link" href="https://docs.docker.com/engine/reference/builder/#run" target="_blank">RUN</a> execute any commands in a new layer on top of the current image and commit the results.</li>
<li data-line="4" dir="auto" data-rve-block="true" tabindex="-1"><span class="list-bullet"></span><a data-tooltip-position="top" aria-label="https://docs.docker.com/engine/reference/builder/#cmd" rel="noopener nofollow" class="external-link" href="https://docs.docker.com/engine/reference/builder/#cmd" target="_blank">CMD</a> provide defaults for an executing container.</li>
<li data-line="5" dir="auto" data-rve-block="true" tabindex="-1"><span class="list-bullet"></span><a data-tooltip-position="top" aria-label="https://docs.docker.com/engine/reference/builder/#expose" rel="noopener nofollow" class="external-link" href="https://docs.docker.com/engine/reference/builder/#expose" target="_blank">EXPOSE</a> informs Docker that the container listens on the specified network ports at runtime.  NOTE: does not actually make ports accessible.</li>
<li data-line="6" dir="auto" data-rve-block="true" tabindex="-1"><span class="list-bullet"></span><a data-tooltip-position="top" aria-label="https://docs.docker.com/engine/reference/builder/#env" rel="noopener nofollow" class="external-link" href="https://docs.docker.com/engine/reference/builder/#env" target="_blank">ENV</a> sets environment variable.</li>
<li data-line="7" dir="auto" data-rve-block="true" tabindex="-1"><span class="list-bullet"></span><a data-tooltip-position="top" aria-label="https://docs.docker.com/engine/reference/builder/#add" rel="noopener nofollow" class="external-link" href="https://docs.docker.com/engine/reference/builder/#add" target="_blank">ADD</a> copies new files, directories or remote file to container.  Invalidates caches. Avoid <code>ADD</code> and use <code>COPY</code> instead.</li>
<li data-line="8" dir="auto" data-rve-block="true" tabindex="-1"><span class="list-bullet"></span><a data-tooltip-position="top" aria-label="https://docs.docker.com/engine/reference/builder/#copy" rel="noopener nofollow" class="external-link" href="https://docs.docker.com/engine/reference/builder/#copy" target="_blank">COPY</a> copies new files or directories to container.  By default this copies as root regardless of the USER/WORKDIR settings.  Use <code>--chown=&lt;user&gt;:&lt;group&gt;</code> to give ownership to another user/group.  (Same for <code>ADD</code>.)</li>
<li data-line="9" dir="auto" data-rve-block="true" tabindex="-1"><span class="list-bullet"></span><a data-tooltip-position="top" aria-label="https://docs.docker.com/engine/reference/builder/#entrypoint" rel="noopener nofollow" class="external-link" href="https://docs.docker.com/engine/reference/builder/#entrypoint" target="_blank">ENTRYPOINT</a> configures a container that will run as an executable.</li>
<li data-line="10" dir="auto" data-rve-block="true" tabindex="-1"><span class="list-bullet"></span><a data-tooltip-position="top" aria-label="https://docs.docker.com/engine/reference/builder/#volume" rel="noopener nofollow" class="external-link" href="https://docs.docker.com/engine/reference/builder/#volume" target="_blank">VOLUME</a> creates a mount point for externally mounted volumes or other containers.</li>
<li data-line="11" dir="auto" data-rve-block="true" tabindex="-1"><span class="list-bullet"></span><a data-tooltip-position="top" aria-label="https://docs.docker.com/engine/reference/builder/#user" rel="noopener nofollow" class="external-link" href="https://docs.docker.com/engine/reference/builder/#user" target="_blank">USER</a> sets the user name for following RUN / CMD / ENTRYPOINT commands.</li>
<li data-line="12" dir="auto" data-rve-block="true" tabindex="-1"><span class="list-bullet"></span><a data-tooltip-position="top" aria-label="https://docs.docker.com/engine/reference/builder/#workdir" rel="noopener nofollow" class="external-link" href="https://docs.docker.com/engine/reference/builder/#workdir" target="_blank">WORKDIR</a> sets the working directory.</li>
<li data-line="13" dir="auto" data-rve-block="true" tabindex="-1"><span class="list-bullet"></span><a data-tooltip-position="top" aria-label="https://docs.docker.com/engine/reference/builder/#arg" rel="noopener nofollow" class="external-link" href="https://docs.docker.com/engine/reference/builder/#arg" target="_blank">ARG</a> defines a build-time variable.</li>
<li data-line="14" dir="auto" data-rve-block="true" tabindex="-1"><span class="list-bullet"></span><a data-tooltip-position="top" aria-label="https://docs.docker.com/engine/reference/builder/#onbuild" rel="noopener nofollow" class="external-link" href="https://docs.docker.com/engine/reference/builder/#onbuild" target="_blank">ONBUILD</a> adds a trigger instruction when the image is used as the base for another build.</li>
<li data-line="15" dir="auto" data-rve-block="true" tabindex="-1"><span class="list-bullet"></span><a data-tooltip-position="top" aria-label="https://docs.docker.com/engine/reference/builder/#stopsignal" rel="noopener nofollow" class="external-link" href="https://docs.docker.com/engine/reference/builder/#stopsignal" target="_blank">STOPSIGNAL</a> sets the system call signal that will be sent to the container to exit.</li>
<li data-line="16" dir="auto" data-rve-block="true" tabindex="-1"><span class="list-bullet"></span><a data-tooltip-position="top" aria-label="https://docs.docker.com/config/labels-custom-metadata/" rel="noopener nofollow" class="external-link" href="https://docs.docker.com/config/labels-custom-metadata/" target="_blank">LABEL</a> apply key/value metadata to your images, containers, or daemons.</li>
<li data-line="17" dir="auto" data-rve-block="true" tabindex="-1"><span class="list-bullet"></span><a data-tooltip-position="top" aria-label="https://docs.docker.com/engine/reference/builder/#shell" rel="noopener nofollow" class="external-link" href="https://docs.docker.com/engine/reference/builder/#shell" target="_blank">SHELL</a> override default shell is used by docker to run commands.</li>
<li data-line="18" dir="auto" data-rve-block="true" tabindex="-1"><span class="list-bullet"></span><a data-tooltip-position="top" aria-label="https://docs.docker.com/engine/reference/builder/#healthcheck" rel="noopener nofollow" class="external-link" href="https://docs.docker.com/engine/reference/builder/#healthcheck" target="_blank">HEALTHCHECK</a> tells docker how to test a container to check that it is still working.</li>
</ul></div><div class="el-h3"><a name="tutorial"></a><br><h3 data-heading="Tutorial" dir="auto" data-rve-block="true" tabindex="-1"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>Tutorial</h3></div><div class="el-ul"><ul class="has-list-bullet">
<li data-line="0" dir="auto" data-rve-block="true" tabindex="-1"><span class="list-bullet"></span><a data-tooltip-position="top" aria-label="https://www.flux7.com/tutorial/docker-tutorial-series-part-3-automation-is-the-word-using-dockerfile/" rel="noopener nofollow" class="external-link" href="https://www.flux7.com/tutorial/docker-tutorial-series-part-3-automation-is-the-word-using-dockerfile/" target="_blank">Flux7's Dockerfile Tutorial</a></li>
</ul></div><div class="el-h3"><a name="examples"></a><br><h3 data-heading="Examples" dir="auto" data-rve-block="true" tabindex="-1"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>Examples</h3></div><div class="el-ul"><ul class="has-list-bullet">
<li data-line="0" dir="auto" data-rve-block="true" tabindex="-1"><span class="list-bullet"></span><a data-tooltip-position="top" aria-label="https://docs.docker.com/engine/reference/builder/#dockerfile-examples" rel="noopener nofollow" class="external-link" href="https://docs.docker.com/engine/reference/builder/#dockerfile-examples" target="_blank">Examples</a></li>
<li data-line="1" dir="auto" data-rve-block="true" tabindex="-1"><span class="list-bullet"></span><a data-tooltip-position="top" aria-label="https://docs.docker.com/engine/userguide/eng-image/dockerfile_best-practices/" rel="noopener nofollow" class="external-link" href="https://docs.docker.com/engine/userguide/eng-image/dockerfile_best-practices/" target="_blank">Best practices for writing Dockerfiles</a></li>
<li data-line="2" dir="auto" data-rve-block="true" tabindex="-1"><span class="list-bullet"></span><a data-tooltip-position="top" aria-label="http://crosbymichael.com/" rel="noopener nofollow" class="external-link" href="http://crosbymichael.com/" target="_blank">Michael Crosby</a> has some more <a data-tooltip-position="top" aria-label="http://crosbymichael.com/dockerfile-best-practices.html" rel="noopener nofollow" class="external-link" href="http://crosbymichael.com/dockerfile-best-practices.html" target="_blank">Dockerfiles best practices</a> / <a data-tooltip-position="top" aria-label="http://crosbymichael.com/dockerfile-best-practices-take-2.html" rel="noopener nofollow" class="external-link" href="http://crosbymichael.com/dockerfile-best-practices-take-2.html" target="_blank">take 2</a>.</li>
<li data-line="3" dir="auto" data-rve-block="true" tabindex="-1"><span class="list-bullet"></span><a data-tooltip-position="top" aria-label="http://jonathan.bergknoff.com/journal/building-good-docker-images" rel="noopener nofollow" class="external-link" href="http://jonathan.bergknoff.com/journal/building-good-docker-images" target="_blank">Building Good Docker Images</a> / <a data-tooltip-position="top" aria-label="http://jonathan.bergknoff.com/journal/building-better-docker-images" rel="noopener nofollow" class="external-link" href="http://jonathan.bergknoff.com/journal/building-better-docker-images" target="_blank">Building Better Docker Images</a></li>
<li data-line="4" dir="auto" data-rve-block="true" tabindex="-1"><span class="list-bullet"></span><a data-tooltip-position="top" aria-label="https://speakerdeck.com/garethr/managing-container-configuration-with-metadata" rel="noopener nofollow" class="external-link" href="https://speakerdeck.com/garethr/managing-container-configuration-with-metadata" target="_blank">Managing Container Configuration with Metadata</a></li>
<li data-line="5" dir="auto" data-rve-block="true" tabindex="-1"><span class="list-bullet"></span><a data-tooltip-position="top" aria-label="https://rock-it.pl/how-to-write-excellent-dockerfiles/" rel="noopener nofollow" class="external-link" href="https://rock-it.pl/how-to-write-excellent-dockerfiles/" target="_blank">How to write excellent Dockerfiles</a></li>
</ul></div><div class="el-h2"><a name="layers"></a><br><h2 data-heading="Layers" dir="auto" data-rve-block="true" tabindex="-1"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>Layers</h2></div><div class="el-p"><p dir="auto" data-rve-block="true" tabindex="-1">The versioned filesystem in Docker is based on layers. They're like <a data-tooltip-position="top" aria-label="https://docs.docker.com/engine/userguide/storagedriver/imagesandcontainers/" rel="noopener nofollow" class="external-link" href="https://docs.docker.com/engine/userguide/storagedriver/imagesandcontainers/" target="_blank">git commits or changesets for filesystems</a>.</p></div><div class="el-h2"><a name="links"></a><br><h2 data-heading="Links" dir="auto" data-rve-block="true" tabindex="-1"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>Links</h2></div><div class="el-p"><p dir="auto" data-rve-block="true" tabindex="-1">Links are how Docker containers talk to each other <a data-tooltip-position="top" aria-label="https://docs.docker.com/engine/userguide/networking/default_network/dockerlinks/" rel="noopener nofollow" class="external-link" href="https://docs.docker.com/engine/userguide/networking/default_network/dockerlinks/" target="_blank">through TCP/IP ports</a>. <a data-tooltip-position="top" aria-label="https://blogs.atlassian.com/2013/11/docker-all-the-things-at-atlassian-automation-and-wiring/" rel="noopener nofollow" class="external-link" href="https://blogs.atlassian.com/2013/11/docker-all-the-things-at-atlassian-automation-and-wiring/" target="_blank">Atlassian</a> show worked examples. You can also resolve <a data-tooltip-position="top" aria-label="https://docs.docker.com/engine/userguide/networking/default_network/dockerlinks/#/updating-the-etchosts-file" rel="noopener nofollow" class="external-link" href="https://docs.docker.com/engine/userguide/networking/default_network/dockerlinks/#/updating-the-etchosts-file" target="_blank">links by hostname</a>.</p></div><div class="el-p"><p dir="auto" data-rve-block="true" tabindex="-1">This has been deprecated to some extent by <a data-tooltip-position="top" aria-label="https://docs.docker.com/network/" rel="noopener nofollow" class="external-link" href="https://docs.docker.com/network/" target="_blank">user-defined networks</a>.</p></div><div class="el-p"><p dir="auto" data-rve-block="true" tabindex="-1">NOTE: If you want containers to ONLY communicate with each other through links, start the docker daemon with <code>-icc=false</code> to disable inter process communication.</p></div><div class="el-p"><p dir="auto" data-rve-block="true" tabindex="-1">If you have a container with the name CONTAINER (specified by <code>docker run --name CONTAINER</code>) and in the Dockerfile, it has an exposed port:</p></div><div class="el-pre"><pre data-rve-block="true" tabindex="-1"><code data-line="0">EXPOSE 1337
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto" data-rve-block="true" tabindex="-1">Then if we create another container called LINKED like so:</p></div><div class="el-pre"><div class="block-language-bash"><div class="expressive-code"><figure class="frame is-terminal"><figcaption class="header"><span class="title"></span><span class="sr-only">Terminal window</span></figcaption><pre data-language="bash"><code><div class="ec-line"><div class="code"><span style="color:#87FF5F">docker</span><span style="color:#BBBBBB"> </span><span style="color:#AB92FC">run</span><span style="color:#BBBBBB"> </span><span style="color:#8EDF5F">-d</span><span style="color:#BBBBBB"> </span><span style="color:#8EDF5F">--link</span><span style="color:#BBBBBB"> </span><span style="color:#AB92FC">CONTAINER:ALIAS</span><span style="color:#BBBBBB"> </span><span style="color:#8EDF5F">--name</span><span style="color:#BBBBBB"> </span><span style="color:#AB92FC">LINKED</span><span style="color:#BBBBBB"> </span><span style="color:#AB92FC">user/wordpress</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="docker run -d --link CONTAINER:ALIAS --name LINKED user/wordpress"><div></div></button></div></figure></div></div></div><div class="el-p"><p dir="auto" data-rve-block="true" tabindex="-1">Then the exposed ports and aliases of CONTAINER will show up in LINKED with the following environment variables:</p></div><div class="el-pre"><div class="block-language-bash"><div class="expressive-code"><figure class="frame is-terminal"><figcaption class="header"><span class="title"></span><span class="sr-only">Terminal window</span></figcaption><pre data-language="bash"><code><div class="ec-line"><div class="code"><span style="color:#E1D6F8">$ALIAS_PORT_1337_TCP_PORT</span></div></div><div class="ec-line"><div class="code"><span style="color:#E1D6F8">$ALIAS_PORT_1337_TCP_ADDR</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="$ALIAS_PORT_1337_TCP_PORT$ALIAS_PORT_1337_TCP_ADDR"><div></div></button></div></figure></div></div></div><div class="el-p"><p dir="auto" data-rve-block="true" tabindex="-1">And you can connect to it that way.</p></div><div class="el-p"><p dir="auto" data-rve-block="true" tabindex="-1">To delete links, use <code>docker rm --link</code>.</p></div><div class="el-p"><p dir="auto" data-rve-block="true" tabindex="-1">Generally, linking between docker services is a subset of "service discovery", a big problem if you're planning to use Docker at scale in production.  Please read <a data-tooltip-position="top" aria-label="https://www.digitalocean.com/community/tutorials/the-docker-ecosystem-service-discovery-and-distributed-configuration-stores" rel="noopener nofollow" class="external-link" href="https://www.digitalocean.com/community/tutorials/the-docker-ecosystem-service-discovery-and-distributed-configuration-stores" target="_blank">The Docker Ecosystem: Service Discovery and Distributed Configuration Stores</a> for more info.</p></div><div class="el-hr"><hr></div><div class="el-h1"><a name="volumes"></a><br><h1 data-heading="Volumes" dir="auto" data-rve-block="true" tabindex="-1"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>Volumes</h1></div><div class="el-p"><p dir="auto" data-rve-block="true" tabindex="-1">Docker volumes are <a data-tooltip-position="top" aria-label="https://docs.docker.com/engine/tutorials/dockervolumes/" rel="noopener nofollow" class="external-link" href="https://docs.docker.com/engine/tutorials/dockervolumes/" target="_blank">free-floating filesystems</a>. They don't have to be connected to a particular container. You can use volumes mounted from <a data-tooltip-position="top" aria-label="https://medium.com/@ramangupta/why-docker-data-containers-are-good-589b3c6c749e" rel="noopener nofollow" class="external-link" href="https://medium.com/@ramangupta/why-docker-data-containers-are-good-589b3c6c749e" target="_blank">data-only containers</a> for portability. As of Docker 1.9.0, Docker has named volumes which replace data-only containers. Consider using named volumes to implement it rather than data containers.</p></div><div class="el-h3"><a name="lifecycle"></a><br><h3 data-heading="Lifecycle" dir="auto" data-rve-block="true" tabindex="-1"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>Lifecycle</h3></div><div class="el-ul"><ul class="has-list-bullet">
<li data-line="0" dir="auto" data-rve-block="true" tabindex="-1"><span class="list-bullet"></span><a data-tooltip-position="top" aria-label="https://docs.docker.com/engine/reference/commandline/volume_create/" rel="noopener nofollow" class="external-link" href="https://docs.docker.com/engine/reference/commandline/volume_create/" target="_blank"><code>docker volume create</code></a></li>
<li data-line="1" dir="auto" data-rve-block="true" tabindex="-1"><span class="list-bullet"></span><a data-tooltip-position="top" aria-label="https://docs.docker.com/engine/reference/commandline/volume_rm/" rel="noopener nofollow" class="external-link" href="https://docs.docker.com/engine/reference/commandline/volume_rm/" target="_blank"><code>docker volume rm</code></a></li>
</ul></div><div class="el-h3"><a name="info"></a><br><h3 data-heading="Info" dir="auto" data-rve-block="true" tabindex="-1"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>Info</h3></div><div class="el-ul"><ul class="has-list-bullet">
<li data-line="0" dir="auto" data-rve-block="true" tabindex="-1"><span class="list-bullet"></span><a data-tooltip-position="top" aria-label="https://docs.docker.com/engine/reference/commandline/volume_ls/" rel="noopener nofollow" class="external-link" href="https://docs.docker.com/engine/reference/commandline/volume_ls/" target="_blank"><code>docker volume ls</code></a></li>
<li data-line="1" dir="auto" data-rve-block="true" tabindex="-1"><span class="list-bullet"></span><a data-tooltip-position="top" aria-label="https://docs.docker.com/engine/reference/commandline/volume_inspect/" rel="noopener nofollow" class="external-link" href="https://docs.docker.com/engine/reference/commandline/volume_inspect/" target="_blank"><code>docker volume inspect</code></a></li>
</ul></div><div class="el-p"><p dir="auto" data-rve-block="true" tabindex="-1">Volumes are useful in situations where you can't use links (which are TCP/IP only). For instance, if you need to have two docker instances communicate by leaving stuff on the filesystem.</p></div><div class="el-p"><p dir="auto" data-rve-block="true" tabindex="-1">You can mount them in several docker containers at once, using <code>docker run --volumes-from</code>.</p></div><div class="el-p"><p dir="auto" data-rve-block="true" tabindex="-1">Because volumes are isolated filesystems, they are often used to store state from computations between transient containers. That is, you can have a stateless and transient container run from a recipe, blow it away, and then have a second instance of the transient container pick up from where the last one left off.</p></div><div class="el-p"><p dir="auto" data-rve-block="true" tabindex="-1">See <a data-tooltip-position="top" aria-label="http://crosbymichael.com/advanced-docker-volumes.html" rel="noopener nofollow" class="external-link" href="http://crosbymichael.com/advanced-docker-volumes.html" target="_blank">advanced volumes</a> for more details. <a data-tooltip-position="top" aria-label="http://container42.com/2014/11/03/docker-indepth-volumes/" rel="noopener nofollow" class="external-link" href="http://container42.com/2014/11/03/docker-indepth-volumes/" target="_blank">Container42</a> is also helpful.</p></div><div class="el-p"><p dir="auto" data-rve-block="true" tabindex="-1">You can <a data-tooltip-position="top" aria-label="https://docs.docker.com/engine/tutorials/dockervolumes/#mount-a-host-directory-as-a-data-volume" rel="noopener nofollow" class="external-link" href="https://docs.docker.com/engine/tutorials/dockervolumes/#mount-a-host-directory-as-a-data-volume" target="_blank">map MacOS host directories as docker volumes</a>:</p></div><div class="el-pre"><div class="block-language-bash"><div class="expressive-code"><figure class="frame is-terminal"><figcaption class="header"><span class="title"></span><span class="sr-only">Terminal window</span></figcaption><pre data-language="bash"><code><div class="ec-line"><div class="code"><span style="color:#87FF5F">docker</span><span style="color:#BBBBBB"> </span><span style="color:#AB92FC">run</span><span style="color:#BBBBBB"> </span><span style="color:#8EDF5F">-v</span><span style="color:#BBBBBB"> </span><span style="color:#AB92FC">/Users/wsargent/myapp/src:/src</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="docker run -v /Users/wsargent/myapp/src:/src"><div></div></button></div></figure></div></div></div><div class="el-p"><p dir="auto" data-rve-block="true" tabindex="-1">You can use remote NFS volumes if you're <a data-tooltip-position="top" aria-label="https://docs.docker.com/engine/tutorials/dockervolumes/#/mount-a-shared-storage-volume-as-a-data-volume" rel="noopener nofollow" class="external-link" href="https://docs.docker.com/engine/tutorials/dockervolumes/#/mount-a-shared-storage-volume-as-a-data-volume" target="_blank">feeling brave</a>.</p></div><div class="el-p"><p dir="auto" data-rve-block="true" tabindex="-1">You may also consider running data-only containers as described <a data-tooltip-position="top" aria-label="http://container42.com/2013/12/16/persistent-volumes-with-docker-container-as-volume-pattern/" rel="noopener nofollow" class="external-link" href="http://container42.com/2013/12/16/persistent-volumes-with-docker-container-as-volume-pattern/" target="_blank">here</a> to provide some data portability.</p></div><div class="el-p"><p dir="auto" data-rve-block="true" tabindex="-1">Be aware that you can <a class="internal-link" data-href="#volumes-can-be-files" href="#volumes-can-be-files" target="_blank" rel="noopener nofollow">mount files as volumes</a>.</p></div><div class="el-h2"><a name="exposing-ports"></a><br><h2 data-heading="Exposing ports" dir="auto" data-rve-block="true" tabindex="-1"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>Exposing ports</h2></div><div class="el-p"><p dir="auto" data-rve-block="true" tabindex="-1">Exposing incoming ports through the host container is <a data-tooltip-position="top" aria-label="https://docs.docker.com/engine/reference/run/#expose-incoming-ports" rel="noopener nofollow" class="external-link" href="https://docs.docker.com/engine/reference/run/#expose-incoming-ports" target="_blank">fiddly but doable</a>.</p></div><div class="el-p"><p dir="auto" data-rve-block="true" tabindex="-1">This is done by mapping the container port to the host port (only using localhost interface) using <code>-p</code>:</p></div><div class="el-pre"><div class="block-language-bash"><div class="expressive-code"><figure class="frame is-terminal"><figcaption class="header"><span class="title"></span><span class="sr-only">Terminal window</span></figcaption><pre data-language="bash"><code><div class="ec-line"><div class="code"><span style="color:#87FF5F">docker</span><span style="color:#BBBBBB"> </span><span style="color:#AB92FC">run</span><span style="color:#BBBBBB"> </span><span style="color:#8EDF5F">-p</span><span style="color:#BBBBBB"> </span><span style="color:#AB92FC">127.0.0.1:</span><span style="color:#E1D6F8">$HOSTPORT</span><span style="color:#AB92FC">:</span><span style="color:#E1D6F8">$CONTAINERPORT</span><span style="color:#BBBBBB"> </span><span style="color:#8EDF5F">\</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="color:#8EDF5F">--name</span><span style="color:#BBBBBB"> </span><span style="color:#AB92FC">CONTAINER</span><span style="color:#BBBBBB"> </span><span style="color:#8EDF5F">\</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="color:#8EDF5F">-t</span><span style="color:#BBBBBB"> </span><span style="color:#AB92FC">someimage</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="docker run -p 127.0.0.1:$HOSTPORT:$CONTAINERPORT \  --name CONTAINER \  -t someimage"><div></div></button></div></figure></div></div></div><div class="el-p"><p dir="auto" data-rve-block="true" tabindex="-1">You can tell Docker that the container listens on the specified network ports at runtime by using <a data-tooltip-position="top" aria-label="https://docs.docker.com/engine/reference/builder/#expose" rel="noopener nofollow" class="external-link" href="https://docs.docker.com/engine/reference/builder/#expose" target="_blank">EXPOSE</a>:</p></div><div class="el-pre"><div class="block-language-dockerfile"><div class="expressive-code"><figure class="frame"><figcaption class="header"></figcaption><pre data-language="dockerfile"><code><div class="ec-line"><div class="code"><span style="color:#B968FC">EXPOSE</span><span style="color:#BBBBBB"> &lt;CONTAINERPORT&gt;</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="EXPOSE <CONTAINERPORT>"><div></div></button></div></figure></div></div></div><div class="el-p"><p dir="auto" data-rve-block="true" tabindex="-1">Note that <code>EXPOSE</code> does not expose the port itself - only <code>-p</code> will do that.</p></div><div class="el-p"><p dir="auto" data-rve-block="true" tabindex="-1">To expose the container's port on your localhost's port, run:</p></div><div class="el-pre"><div class="block-language-bash"><div class="expressive-code"><figure class="frame is-terminal"><figcaption class="header"><span class="title"></span><span class="sr-only">Terminal window</span></figcaption><pre data-language="bash"><code><div class="ec-line"><div class="code"><span style="color:#87FF5F">iptables</span><span style="color:#BBBBBB"> </span><span style="color:#8EDF5F">-t</span><span style="color:#BBBBBB"> </span><span style="color:#AB92FC">nat</span><span style="color:#BBBBBB"> </span><span style="color:#8EDF5F">-A</span><span style="color:#BBBBBB"> </span><span style="color:#AB92FC">DOCKER</span><span style="color:#BBBBBB"> </span><span style="color:#8EDF5F">-p</span><span style="color:#BBBBBB"> </span><span style="color:#AB92FC">tcp</span><span style="color:#BBBBBB"> </span><span style="color:#8EDF5F">--dport</span><span style="color:#BBBBBB"> </span><span style="color:#AB92FC">&lt;LOCALHOSTPORT&gt;</span><span style="color:#BBBBBB"> </span><span style="color:#8EDF5F">-j</span><span style="color:#BBBBBB"> </span><span style="color:#AB92FC">DNAT</span><span style="color:#BBBBBB"> </span><span style="color:#8EDF5F">--to-destination</span><span style="color:#BBBBBB"> </span><span style="color:#AB92FC">&lt;CONTAINERIP&gt;:&lt;PORT&gt;</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="iptables -t nat -A DOCKER -p tcp --dport <LOCALHOSTPORT> -j DNAT --to-destination <CONTAINERIP>:<PORT>"><div></div></button></div></figure></div></div></div><div class="el-p"><p dir="auto" data-rve-block="true" tabindex="-1">If you're running Docker in Virtualbox, you then need to forward the port there as well, using <a data-tooltip-position="top" aria-label="https://docs.vagrantup.com/v2/networking/forwarded_ports.html" rel="noopener nofollow" class="external-link" href="https://docs.vagrantup.com/v2/networking/forwarded_ports.html" target="_blank">forwarded_port</a>. Define a range of ports in your Vagrantfile like this so you can dynamically map them:</p></div><div class="el-pre"><pre data-rve-block="true" tabindex="-1"><code data-line="0">Vagrant.configure(VAGRANTFILE_API_VERSION) do |config|
  ...

  (49000..49900).each do |port|
    config.vm.network :forwarded_port, :host =&gt; port, :guest =&gt; port
  end

  ...
end
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto" data-rve-block="true" tabindex="-1">If you forget what you mapped the port to on the host container, use <code>docker port</code> to show it:</p></div><div class="el-pre"><div class="block-language-bash"><div class="expressive-code"><figure class="frame is-terminal"><figcaption class="header"><span class="title"></span><span class="sr-only">Terminal window</span></figcaption><pre data-language="bash"><code><div class="ec-line"><div class="code"><span style="color:#87FF5F">docker</span><span style="color:#BBBBBB"> </span><span style="color:#AB92FC">port</span><span style="color:#BBBBBB"> </span><span style="color:#AB92FC">CONTAINER</span><span style="color:#BBBBBB"> </span><span style="color:#E1D6F8">$CONTAINERPORT</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="docker port CONTAINER $CONTAINERPORT"><div></div></button></div></figure></div></div></div><div class="el-h2"><a name="best-practices"></a><br><h2 data-heading="Best Practices" dir="auto" data-rve-block="true" tabindex="-1"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>Best Practices</h2></div><div class="el-p"><p dir="auto" data-rve-block="true" tabindex="-1">This is where general Docker best practices and war stories go:</p></div><div class="el-ul"><ul class="has-list-bullet">
<li data-line="0" dir="auto" data-rve-block="true" tabindex="-1"><span class="list-bullet"></span><a data-tooltip-position="top" aria-label="http://gregoryszorc.com/blog/2014/10/16/the-rabbit-hole-of-using-docker-in-automated-tests/" rel="noopener nofollow" class="external-link" href="http://gregoryszorc.com/blog/2014/10/16/the-rabbit-hole-of-using-docker-in-automated-tests/" target="_blank">The Rabbit Hole of Using Docker in Automated Tests</a></li>
<li data-line="1" dir="auto" data-rve-block="true" tabindex="-1"><span class="list-bullet"></span><a data-tooltip-position="top" aria-label="https://twitter.com/bridgetkromhout" rel="noopener nofollow" class="external-link" href="https://twitter.com/bridgetkromhout" target="_blank">Bridget Kromhout</a> has a useful blog post on <a data-tooltip-position="top" aria-label="http://sysadvent.blogspot.co.uk/2014/12/day-1-docker-in-production-reality-not.html" rel="noopener nofollow" class="external-link" href="http://sysadvent.blogspot.co.uk/2014/12/day-1-docker-in-production-reality-not.html" target="_blank">running Docker in production</a> at Dramafever.</li>
<li data-line="2" dir="auto" data-rve-block="true" tabindex="-1"><span class="list-bullet"></span>There's also a best practices <a data-tooltip-position="top" aria-label="http://developers.lyst.com/devops/2014/12/08/docker/" rel="noopener nofollow" class="external-link" href="http://developers.lyst.com/devops/2014/12/08/docker/" target="_blank">blog post</a> from Lyst.</li>
<li data-line="3" dir="auto" data-rve-block="true" tabindex="-1"><span class="list-bullet"></span><a data-tooltip-position="top" aria-label="https://tersesystems.com/2013/11/20/building-a-development-environment-with-docker/" rel="noopener nofollow" class="external-link" href="https://tersesystems.com/2013/11/20/building-a-development-environment-with-docker/" target="_blank">Building a Development Environment With Docker</a></li>
<li data-line="4" dir="auto" data-rve-block="true" tabindex="-1"><span class="list-bullet"></span><a data-tooltip-position="top" aria-label="https://samsaffron.com/archive/2013/11/07/discourse-in-a-docker-container" rel="noopener nofollow" class="external-link" href="https://samsaffron.com/archive/2013/11/07/discourse-in-a-docker-container" target="_blank">Discourse in a Docker Container</a></li>
</ul></div><div class="el-h2"><a name="docker-compose"></a><br><h2 data-heading="Docker-Compose" dir="auto" data-rve-block="true" tabindex="-1"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>Docker-Compose</h2></div><div class="el-p"><p dir="auto" data-rve-block="true" tabindex="-1">Compose is a tool for defining and running multi-container Docker applications. With Compose, you use a YAML file to configure your application‚Äôs services. Then, with a single command, you create and start all the services from your configuration. To learn more about all the features of Compose, see the <a data-tooltip-position="top" aria-label="https://docs.docker.com/compose/overview/#features" rel="noopener nofollow" class="external-link" href="https://docs.docker.com/compose/overview/#features" target="_blank">list of features</a>.</p></div><div class="el-p"><p dir="auto" data-rve-block="true" tabindex="-1">By using the following command you can start up your application:</p></div><div class="el-pre"><div class="block-language-bash"><div class="expressive-code"><figure class="frame is-terminal"><figcaption class="header"><span class="title"></span><span class="sr-only">Terminal window</span></figcaption><pre data-language="bash"><code><div class="ec-line"><div class="code"><span style="color:#87FF5F">docker-compose</span><span style="color:#BBBBBB"> </span><span style="color:#8EDF5F">-f</span><span style="color:#BBBBBB"> </span><span style="color:#AB92FC">&lt;docker-compose-file&gt;</span><span style="color:#BBBBBB"> </span><span style="color:#AB92FC">up</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="docker-compose -f <docker-compose-file> up"><div></div></button></div></figure></div></div></div><div class="el-p"><p dir="auto" data-rve-block="true" tabindex="-1">You can also run docker-compose in detached mode using -d flag, then you can stop it whenever needed by the following command:</p></div><div class="el-pre"><div class="block-language-bash"><div class="expressive-code"><figure class="frame is-terminal"><figcaption class="header"><span class="title"></span><span class="sr-only">Terminal window</span></figcaption><pre data-language="bash"><code><div class="ec-line"><div class="code"><span style="color:#87FF5F">docker-compose</span><span style="color:#BBBBBB"> </span><span style="color:#AB92FC">stop</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="docker-compose stop"><div></div></button></div></figure></div></div></div><div class="el-p"><p dir="auto" data-rve-block="true" tabindex="-1">You can bring everything down, removing the containers entirely, with the down command. Pass <code>--volumes</code> to also remove the data volume.</p></div><div class="el-hr"><hr></div><div class="el-h1"><a name="security"></a><br><h1 data-heading="Security" dir="auto" data-rve-block="true" tabindex="-1"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>Security</h1></div><div class="el-p"><p dir="auto" data-rve-block="true" tabindex="-1">This is where security tips about Docker go. The Docker <a data-tooltip-position="top" aria-label="https://docs.docker.com/engine/security/security/" rel="noopener nofollow" class="external-link" href="https://docs.docker.com/engine/security/security/" target="_blank">security</a> page goes into more detail.</p></div><div class="el-p"><p dir="auto" data-rve-block="true" tabindex="-1">First things first: Docker runs as root. If you are in the <code>docker</code> group, you effectively <a data-tooltip-position="top" aria-label="https://web.archive.org/web/20161226211755/http://reventlov.com/advisories/using-the-docker-command-to-root-the-host" rel="noopener nofollow" class="external-link" href="https://web.archive.org/web/20161226211755/http://reventlov.com/advisories/using-the-docker-command-to-root-the-host" target="_blank">have root access</a>. If you expose the docker unix socket to a container, you are giving the container <a data-tooltip-position="top" aria-label="https://www.lvh.io/posts/dont-expose-the-docker-socket-not-even-to-a-container/" rel="noopener nofollow" class="external-link" href="https://www.lvh.io/posts/dont-expose-the-docker-socket-not-even-to-a-container/" target="_blank">root access to the host</a>.</p></div><div class="el-p"><p dir="auto" data-rve-block="true" tabindex="-1">Docker should not be your only defense. You should secure and harden it.</p></div><div class="el-p"><p dir="auto" data-rve-block="true" tabindex="-1">For an understanding of what containers leave exposed, you should read <a data-tooltip-position="top" aria-label="https://www.nccgroup.trust/globalassets/our-research/us/whitepapers/2016/april/ncc_group_understanding_hardening_linux_containers-1-1.pdf" rel="noopener nofollow" class="external-link" href="https://www.nccgroup.trust/globalassets/our-research/us/whitepapers/2016/april/ncc_group_understanding_hardening_linux_containers-1-1.pdf" target="_blank">Understanding and Hardening Linux Containers</a> by <a data-tooltip-position="top" aria-label="https://twitter.com/dyn___" rel="noopener nofollow" class="external-link" href="https://twitter.com/dyn___" target="_blank">Aaron Grattafiori</a>. This is a complete and comprehensive guide to the issues involved with containers, with a plethora of links and footnotes leading on to yet more useful content. The security tips following are useful if you've already hardened containers in the past, but are not a substitute for understanding.</p></div><div class="el-h3"><a name="security-tips"></a><br><h3 data-heading="Security Tips" dir="auto" data-rve-block="true" tabindex="-1"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>Security Tips</h3></div><div class="el-p"><p dir="auto" data-rve-block="true" tabindex="-1">For greatest security, you want to run Docker inside a virtual machine. This is straight from the Docker Security Team Lead -- <a data-tooltip-position="top" aria-label="http://www.slideshare.net/jpetazzo/linux-containers-lxc-docker-and-security" rel="noopener nofollow" class="external-link" href="http://www.slideshare.net/jpetazzo/linux-containers-lxc-docker-and-security" target="_blank">slides</a> / <a data-tooltip-position="top" aria-label="http://www.projectatomic.io/blog/2014/08/is-it-safe-a-look-at-docker-and-security-from-linuxcon/" rel="noopener nofollow" class="external-link" href="http://www.projectatomic.io/blog/2014/08/is-it-safe-a-look-at-docker-and-security-from-linuxcon/" target="_blank">notes</a>. Then, run with AppArmor / seccomp / SELinux / grsec etc to <a data-tooltip-position="top" aria-label="http://linux-audit.com/docker-security-best-practices-for-your-vessel-and-containers/" rel="noopener nofollow" class="external-link" href="http://linux-audit.com/docker-security-best-practices-for-your-vessel-and-containers/" target="_blank">limit the container permissions</a>. See the <a data-tooltip-position="top" aria-label="https://blog.docker.com/2016/02/docker-engine-1-10-security/" rel="noopener nofollow" class="external-link" href="https://blog.docker.com/2016/02/docker-engine-1-10-security/" target="_blank">Docker 1.10 security features</a> for more details.</p></div><div class="el-p"><p dir="auto" data-rve-block="true" tabindex="-1">Docker image ids are <a data-tooltip-position="top" aria-label="https://medium.com/@quayio/your-docker-image-ids-are-secrets-and-its-time-you-treated-them-that-way-f55e9f14c1a4" rel="noopener nofollow" class="external-link" href="https://medium.com/@quayio/your-docker-image-ids-are-secrets-and-its-time-you-treated-them-that-way-f55e9f14c1a4" target="_blank">sensitive information</a> and should not be exposed to the outside world. Treat them like passwords.</p></div><div class="el-p"><p dir="auto" data-rve-block="true" tabindex="-1">See the <a data-tooltip-position="top" aria-label="https://github.com/konstruktoid/Docker/blob/master/Security/CheatSheet.adoc" rel="noopener nofollow" class="external-link" href="https://github.com/konstruktoid/Docker/blob/master/Security/CheatSheet.adoc" target="_blank">Docker Security Cheat Sheet</a> by <a data-tooltip-position="top" aria-label="https://github.com/konstruktoid" rel="noopener nofollow" class="external-link" href="https://github.com/konstruktoid" target="_blank">Thomas Sj√∂gren</a>: some good stuff about container hardening in there.</p></div><div class="el-p"><p dir="auto" data-rve-block="true" tabindex="-1">Check out the <a data-tooltip-position="top" aria-label="https://github.com/docker/docker-bench-security" rel="noopener nofollow" class="external-link" href="https://github.com/docker/docker-bench-security" target="_blank">docker bench security script</a>, download the <a data-tooltip-position="top" aria-label="https://blog.docker.com/2015/05/understanding-docker-security-and-best-practices/" rel="noopener nofollow" class="external-link" href="https://blog.docker.com/2015/05/understanding-docker-security-and-best-practices/" target="_blank">white papers</a>.</p></div><div class="el-p"><p dir="auto" data-rve-block="true" tabindex="-1">Snyk's <a data-tooltip-position="top" aria-label="https://snyk.io/blog/10-docker-image-security-best-practices/" rel="noopener nofollow" class="external-link" href="https://snyk.io/blog/10-docker-image-security-best-practices/" target="_blank">10 Docker Image Security Best Practices cheat sheet</a></p></div><div class="el-p"><p dir="auto" data-rve-block="true" tabindex="-1">You should start off by using a kernel with unstable patches for grsecurity / pax compiled in, such as <a data-tooltip-position="top" aria-label="https://en.wikipedia.org/wiki/Alpine_Linux" rel="noopener nofollow" class="external-link" href="https://en.wikipedia.org/wiki/Alpine_Linux" target="_blank">Alpine Linux</a>. If you are using grsecurity in production, you should spring for <a data-tooltip-position="top" aria-label="https://grsecurity.net/business_support.php" rel="noopener nofollow" class="external-link" href="https://grsecurity.net/business_support.php" target="_blank">commercial support</a> for the <a data-tooltip-position="top" aria-label="https://grsecurity.net/announce.php" rel="noopener nofollow" class="external-link" href="https://grsecurity.net/announce.php" target="_blank">stable patches</a>, same as you would do for RedHat. It's $200 a month, which is nothing to your devops budget.</p></div><div class="el-p"><p dir="auto" data-rve-block="true" tabindex="-1">Since docker 1.11 you can easily limit the number of active processes running inside a container to prevent fork bombs. This requires a linux kernel &gt;= 4.3 with CGROUP_PIDS=y to be in the kernel configuration.</p></div><div class="el-pre"><pre data-rve-block="true" tabindex="-1" class="language-sb"><code data-line="0" class="language-sb is-loaded">docker run --pids-limit=64
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto" data-rve-block="true" tabindex="-1">Also available since docker 1.11 is the ability to prevent processes from gaining new privileges. This feature have been in the linux kernel since version 3.5. You can read more about it in <a data-tooltip-position="top" aria-label="http://www.projectatomic.io/blog/2016/03/no-new-privs-docker/" rel="noopener nofollow" class="external-link" href="http://www.projectatomic.io/blog/2016/03/no-new-privs-docker/" target="_blank">this</a> blog post.</p></div><div class="el-pre"><div class="block-language-bash"><div class="expressive-code"><figure class="frame is-terminal"><figcaption class="header"><span class="title"></span><span class="sr-only">Terminal window</span></figcaption><pre data-language="bash"><code><div class="ec-line"><div class="code"><span style="color:#87FF5F">docker</span><span style="color:#BBBBBB"> </span><span style="color:#AB92FC">run</span><span style="color:#BBBBBB"> </span><span style="color:#8EDF5F">--security-opt=no-new-privileges</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="docker run --security-opt=no-new-privileges"><div></div></button></div></figure></div></div></div><div class="el-p"><p dir="auto" data-rve-block="true" tabindex="-1">From the <a data-tooltip-position="top" aria-label="http://container-solutions.com/content/uploads/2015/06/15.06.15_DockerCheatSheet_A2.pdf" rel="noopener nofollow" class="external-link" href="http://container-solutions.com/content/uploads/2015/06/15.06.15_DockerCheatSheet_A2.pdf" target="_blank">Docker Security Cheat Sheet</a> (it's in PDF which makes it hard to use, so copying below) by <a data-tooltip-position="top" aria-label="http://container-solutions.com/is-docker-safe-for-production/" rel="noopener nofollow" class="external-link" href="http://container-solutions.com/is-docker-safe-for-production/" target="_blank">Container Solutions</a>:</p></div><div class="el-p"><p dir="auto" data-rve-block="true" tabindex="-1">Turn off interprocess communication with:</p></div><div class="el-pre"><div class="block-language-bash"><div class="expressive-code"><figure class="frame is-terminal"><figcaption class="header"><span class="title"></span><span class="sr-only">Terminal window</span></figcaption><pre data-language="bash"><code><div class="ec-line"><div class="code"><span style="color:#87FF5F">docker</span><span style="color:#BBBBBB"> </span><span style="color:#8EDF5F">-d</span><span style="color:#BBBBBB"> </span><span style="color:#8EDF5F">--icc=false</span><span style="color:#BBBBBB"> </span><span style="color:#8EDF5F">--iptables</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="docker -d --icc=false --iptables"><div></div></button></div></figure></div></div></div><div class="el-p"><p dir="auto" data-rve-block="true" tabindex="-1">Set the container to be read-only:</p></div><div class="el-pre"><div class="block-language-bash"><div class="expressive-code"><figure class="frame is-terminal"><figcaption class="header"><span class="title"></span><span class="sr-only">Terminal window</span></figcaption><pre data-language="bash"><code><div class="ec-line"><div class="code"><span style="color:#87FF5F">docker</span><span style="color:#BBBBBB"> </span><span style="color:#AB92FC">run</span><span style="color:#BBBBBB"> </span><span style="color:#8EDF5F">--read-only</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="docker run --read-only"><div></div></button></div></figure></div></div></div><div class="el-p"><p dir="auto" data-rve-block="true" tabindex="-1">Verify images with a hashsum:</p></div><div class="el-pre"><div class="block-language-bash"><div class="expressive-code"><figure class="frame is-terminal"><figcaption class="header"><span class="title"></span><span class="sr-only">Terminal window</span></figcaption><pre data-language="bash"><code><div class="ec-line"><div class="code"><span style="color:#87FF5F">docker</span><span style="color:#BBBBBB"> </span><span style="color:#AB92FC">pull</span><span style="color:#BBBBBB"> </span><span style="color:#AB92FC">debian@sha256:a25306f3850e1bd44541976aa7b5fd0a29be</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="docker pull debian@sha256:a25306f3850e1bd44541976aa7b5fd0a29be"><div></div></button></div></figure></div></div></div><div class="el-p"><p dir="auto" data-rve-block="true" tabindex="-1">Set volumes to be read only:</p></div><div class="el-pre"><div class="block-language-bash"><div class="expressive-code"><figure class="frame is-terminal"><figcaption class="header"><span class="title"></span><span class="sr-only">Terminal window</span></figcaption><pre data-language="bash"><code><div class="ec-line"><div class="code"><span style="color:#87FF5F">docker</span><span style="color:#BBBBBB"> </span><span style="color:#AB92FC">run</span><span style="color:#BBBBBB"> </span><span style="color:#8EDF5F">-v</span><span style="color:#BBBBBB"> $(</span><span style="color:#87FF5F">pwd</span><span style="color:#BBBBBB">)</span><span style="color:#AB92FC">/secrets:/secrets:ro</span><span style="color:#BBBBBB"> </span><span style="color:#AB92FC">debian</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="docker run -v $(pwd)/secrets:/secrets:ro debian"><div></div></button></div></figure></div></div></div><div class="el-p"><p dir="auto" data-rve-block="true" tabindex="-1">Define and run a user in your Dockerfile so you don't run as root inside the container:</p></div><div class="el-pre"><div class="block-language-dockerfile"><div class="expressive-code"><figure class="frame"><figcaption class="header"></figcaption><pre data-language="dockerfile"><code><div class="ec-line"><div class="code"><span style="color:#B968FC">RUN</span><span style="color:#BBBBBB"> groupadd -r user &amp;&amp; useradd -r -g user user</span></div></div><div class="ec-line"><div class="code"><span style="color:#B968FC">USER</span><span style="color:#BBBBBB"> user</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="RUN groupadd -r user &amp;&amp; useradd -r -g user userUSER user"><div></div></button></div></figure></div></div></div><div class="el-h3"><a name="user-namespaces"></a><br><h3 data-heading="User Namespaces" dir="auto" data-rve-block="true" tabindex="-1"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>User Namespaces</h3></div><div class="el-p"><p dir="auto" data-rve-block="true" tabindex="-1">There's also work on <a data-tooltip-position="top" aria-label="https://s3hh.wordpress.com/2013/07/19/creating-and-using-containers-without-privilege/" rel="noopener nofollow" class="external-link" href="https://s3hh.wordpress.com/2013/07/19/creating-and-using-containers-without-privilege/" target="_blank">user namespaces</a> -- it is in 1.10 but is not enabled by default.</p></div><div class="el-p"><p dir="auto" data-rve-block="true" tabindex="-1">To enable user namespaces ("remap the userns") in Ubuntu 15.10, <a data-tooltip-position="top" aria-label="https://raesene.github.io/blog/2016/02/04/Docker-User-Namespaces/" rel="noopener nofollow" class="external-link" href="https://raesene.github.io/blog/2016/02/04/Docker-User-Namespaces/" target="_blank">follow the blog example</a>.</p></div><div class="el-h3"><a name="security-videos"></a><br><h3 data-heading="Security Videos" dir="auto" data-rve-block="true" tabindex="-1"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>Security Videos</h3></div><div class="el-ul"><ul class="has-list-bullet">
<li data-line="0" dir="auto" data-rve-block="true" tabindex="-1"><span class="list-bullet"></span><a data-tooltip-position="top" aria-label="https://youtu.be/04LOuMgNj9U" rel="noopener nofollow" class="external-link" href="https://youtu.be/04LOuMgNj9U" target="_blank">Using Docker Safely</a></li>
<li data-line="1" dir="auto" data-rve-block="true" tabindex="-1"><span class="list-bullet"></span><a data-tooltip-position="top" aria-label="https://youtu.be/KmxOXmPhZbk" rel="noopener nofollow" class="external-link" href="https://youtu.be/KmxOXmPhZbk" target="_blank">Securing your applications using Docker</a></li>
<li data-line="2" dir="auto" data-rve-block="true" tabindex="-1"><span class="list-bullet"></span><a data-tooltip-position="top" aria-label="https://youtu.be/a9lE9Urr6AQ" rel="noopener nofollow" class="external-link" href="https://youtu.be/a9lE9Urr6AQ" target="_blank">Container security: Do containers actually contain?</a></li>
<li data-line="3" dir="auto" data-rve-block="true" tabindex="-1"><span class="list-bullet"></span><a data-tooltip-position="top" aria-label="https://www.youtube.com/watch?v=iN6QbszB1R8" rel="noopener nofollow" class="external-link" href="https://www.youtube.com/watch?v=iN6QbszB1R8" target="_blank">Linux Containers: Future or Fantasy?</a></li>
</ul></div><div class="el-h3"><a name="security-roadmap"></a><br><h3 data-heading="Security Roadmap" dir="auto" data-rve-block="true" tabindex="-1"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>Security Roadmap</h3></div><div class="el-p"><p dir="auto" data-rve-block="true" tabindex="-1">The Docker roadmap talks about <a data-tooltip-position="top" aria-label="https://github.com/docker/docker/blob/master/ROADMAP.md#11-security" rel="noopener nofollow" class="external-link" href="https://github.com/docker/docker/blob/master/ROADMAP.md#11-security" target="_blank">seccomp support</a>.<br>
There is an AppArmor policy generator called <a data-tooltip-position="top" aria-label="https://github.com/jfrazelle/bane" rel="noopener nofollow" class="external-link" href="https://github.com/jfrazelle/bane" target="_blank">bane</a>, and they're working on <a data-tooltip-position="top" aria-label="https://github.com/docker/docker/issues/17142" rel="noopener nofollow" class="external-link" href="https://github.com/docker/docker/issues/17142" target="_blank">security profiles</a>.</p></div><div class="el-hr"><hr></div><div class="el-h1"><a name="tips"></a><br><h1 data-heading="Tips" dir="auto" data-rve-block="true" tabindex="-1"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>Tips</h1></div><div class="el-p"><p dir="auto" data-rve-block="true" tabindex="-1">Sources:</p></div><div class="el-ul"><ul class="has-list-bullet">
<li data-line="0" dir="auto" data-rve-block="true" tabindex="-1"><span class="list-bullet"></span><a data-tooltip-position="top" aria-label="http://sssslide.com/speakerdeck.com/bmorearty/15-docker-tips-in-5-minutes" rel="noopener nofollow" class="external-link" href="http://sssslide.com/speakerdeck.com/bmorearty/15-docker-tips-in-5-minutes" target="_blank">15 Docker Tips in 5 minutes</a></li>
<li data-line="1" dir="auto" data-rve-block="true" tabindex="-1"><span class="list-bullet"></span><a data-tooltip-position="top" aria-label="https://codefresh.io/blog/everyday-hacks-docker/" rel="noopener nofollow" class="external-link" href="https://codefresh.io/blog/everyday-hacks-docker/" target="_blank">CodeFresh Everyday Hacks Docker</a></li>
</ul></div><div class="el-h3"><a name="prune"></a><br><h3 data-heading="Prune" dir="auto" data-rve-block="true" tabindex="-1"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>Prune</h3></div><div class="el-p"><p dir="auto" data-rve-block="true" tabindex="-1">The new <a data-tooltip-position="top" aria-label="https://github.com/docker/docker/pull/26108" rel="noopener nofollow" class="external-link" href="https://github.com/docker/docker/pull/26108" target="_blank">Data Management Commands</a> have landed as of Docker 1.13:</p></div><div class="el-ul"><ul class="has-list-bullet">
<li data-line="0" dir="auto" data-rve-block="true" tabindex="-1"><span class="list-bullet"></span><code>docker system prune</code></li>
<li data-line="1" dir="auto" data-rve-block="true" tabindex="-1"><span class="list-bullet"></span><code>docker volume prune</code></li>
<li data-line="2" dir="auto" data-rve-block="true" tabindex="-1"><span class="list-bullet"></span><code>docker network prune</code></li>
<li data-line="3" dir="auto" data-rve-block="true" tabindex="-1"><span class="list-bullet"></span><code>docker container prune</code></li>
<li data-line="4" dir="auto" data-rve-block="true" tabindex="-1"><span class="list-bullet"></span><code>docker image prune</code></li>
</ul></div><div class="el-h3"><a name="df"></a><br><h3 data-heading="df" dir="auto" data-rve-block="true" tabindex="-1"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>df</h3></div><div class="el-p"><p dir="auto" data-rve-block="true" tabindex="-1"><code>docker system df</code> presents a summary of the space currently used by different docker objects.</p></div><div class="el-h3"><a name="heredoc-docker-container"></a><br><h3 data-heading="Heredoc Docker Container" dir="auto" data-rve-block="true" tabindex="-1"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>Heredoc Docker Container</h3></div><div class="el-pre"><div class="block-language-bash"><div class="expressive-code"><figure class="frame is-terminal"><figcaption class="header"><span class="title"></span><span class="sr-only">Terminal window</span></figcaption><pre data-language="bash"><code><div class="ec-line"><div class="code"><span style="color:#87FF5F">docker</span><span style="color:#BBBBBB"> </span><span style="color:#AB92FC">build</span><span style="color:#BBBBBB"> </span><span style="color:#8EDF5F">-t</span><span style="color:#BBBBBB"> </span><span style="color:#AB92FC">htop</span><span style="color:#BBBBBB"> </span><span style="color:#AB92FC">-</span><span style="color:#BBBBBB"> </span><span style="color:#B968FC">&lt;&lt;</span><span style="color:#BBBBBB"> </span><span style="color:#BBBBBB">EOF</span></div></div><div class="ec-line"><div class="code"><span style="color:#AB92FC">FROM alpine</span></div></div><div class="ec-line"><div class="code"><span style="color:#AB92FC">RUN apk --no-cache add htop</span></div></div><div class="ec-line"><div class="code"><span style="color:#BBBBBB">EOF</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="docker build -t htop - << EOFFROM alpineRUN apk --no-cache add htopEOF"><div></div></button></div></figure></div></div></div><div class="el-h3"><a name="last-ids"></a><br><h3 data-heading="Last IDs" dir="auto" data-rve-block="true" tabindex="-1"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>Last IDs</h3></div><div class="el-pre"><div class="block-language-bash"><div class="expressive-code"><figure class="frame is-terminal"><figcaption class="header"><span class="title"></span><span class="sr-only">Terminal window</span></figcaption><pre data-language="bash"><code><div class="ec-line"><div class="code"><span style="color:#9CDA7C">alias</span><span style="color:#BBBBBB"> </span><span style="color:#E1D6F8">dl</span><span style="color:#B968FC">=</span><span style="color:#AB92FC">'docker ps -l -q'</span></div></div><div class="ec-line"><div class="code"><span style="color:#87FF5F">docker</span><span style="color:#BBBBBB"> </span><span style="color:#AB92FC">run</span><span style="color:#BBBBBB"> </span><span style="color:#AB92FC">ubuntu</span><span style="color:#BBBBBB"> </span><span style="color:#AB92FC">echo</span><span style="color:#BBBBBB"> </span><span style="color:#AB92FC">hello</span><span style="color:#BBBBBB"> </span><span style="color:#AB92FC">world</span></div></div><div class="ec-line"><div class="code"><span style="color:#87FF5F">docker</span><span style="color:#BBBBBB"> </span><span style="color:#AB92FC">commit</span><span style="color:#BBBBBB"> $(</span><span style="color:#87FF5F">dl</span><span style="color:#BBBBBB">) </span><span style="color:#AB92FC">helloworld</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="alias dl='docker ps -l -q'docker run ubuntu echo hello worlddocker commit $(dl) helloworld"><div></div></button></div></figure></div></div></div><div class="el-h3"><a name="commit-with-command-needs-dockerfile-"></a><br><h3 data-heading="Commit with command (needs Dockerfile)" dir="auto" data-rve-block="true" tabindex="-1"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>Commit with command (needs Dockerfile)</h3></div><div class="el-pre"><div class="block-language-bash"><div class="expressive-code"><figure class="frame is-terminal"><figcaption class="header"><span class="title"></span><span class="sr-only">Terminal window</span></figcaption><pre data-language="bash"><code><div class="ec-line"><div class="code"><span style="color:#87FF5F">docker</span><span style="color:#BBBBBB"> </span><span style="color:#AB92FC">commit</span><span style="color:#BBBBBB"> </span><span style="color:#8EDF5F">-run=</span><span style="color:#AB92FC">'{"Cmd":["postgres", "-too -many -opts"]}'</span><span style="color:#BBBBBB"> $(</span><span style="color:#87FF5F">dl</span><span style="color:#BBBBBB">) </span><span style="color:#AB92FC">postgres</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="docker commit -run='{&quot;Cmd&quot;:[&quot;postgres&quot;, &quot;-too -many -opts&quot;]}' $(dl) postgres"><div></div></button></div></figure></div></div></div><div class="el-h3"><a name="get-ip-address"></a><br><h3 data-heading="Get IP address" dir="auto" data-rve-block="true" tabindex="-1"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>Get IP address</h3></div><div class="el-pre"><div class="block-language-bash"><div class="expressive-code"><figure class="frame is-terminal"><figcaption class="header"><span class="title"></span><span class="sr-only">Terminal window</span></figcaption><pre data-language="bash"><code><div class="ec-line"><div class="code"><span style="color:#87FF5F">docker</span><span style="color:#BBBBBB"> </span><span style="color:#AB92FC">inspect</span><span style="color:#BBBBBB"> $(</span><span style="color:#87FF5F">dl</span><span style="color:#BBBBBB">) </span><span style="color:#B968FC">|</span><span style="color:#BBBBBB"> </span><span style="color:#87FF5F">grep</span><span style="color:#BBBBBB"> </span><span style="color:#8EDF5F">-wm1</span><span style="color:#BBBBBB"> </span><span style="color:#AB92FC">IPAddress</span><span style="color:#BBBBBB"> </span><span style="color:#B968FC">|</span><span style="color:#BBBBBB"> </span><span style="color:#87FF5F">cut</span><span style="color:#BBBBBB"> </span><span style="color:#8EDF5F">-d</span><span style="color:#BBBBBB"> </span><span style="color:#AB92FC">'"'</span><span style="color:#BBBBBB"> </span><span style="color:#8EDF5F">-f</span><span style="color:#BBBBBB"> </span><span style="color:#87FF5F">4</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="docker inspect $(dl) | grep -wm1 IPAddress | cut -d '&quot;' -f 4"><div></div></button></div></figure></div></div></div><div class="el-p"><p dir="auto" data-rve-block="true" tabindex="-1">Or with <a data-tooltip-position="top" aria-label="https://stedolan.github.io/jq/" rel="noopener nofollow" class="external-link" href="https://stedolan.github.io/jq/" target="_blank">jq</a> installed:</p></div><div class="el-pre"><div class="block-language-bash"><div class="expressive-code"><figure class="frame is-terminal"><figcaption class="header"><span class="title"></span><span class="sr-only">Terminal window</span></figcaption><pre data-language="bash"><code><div class="ec-line"><div class="code"><span style="color:#87FF5F">docker</span><span style="color:#BBBBBB"> </span><span style="color:#AB92FC">inspect</span><span style="color:#BBBBBB"> $(</span><span style="color:#87FF5F">dl</span><span style="color:#BBBBBB">) </span><span style="color:#B968FC">|</span><span style="color:#BBBBBB"> </span><span style="color:#87FF5F">jq</span><span style="color:#BBBBBB"> </span><span style="color:#8EDF5F">-r</span><span style="color:#BBBBBB"> </span><span style="color:#AB92FC">'.[0].NetworkSettings.IPAddress'</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="docker inspect $(dl) | jq -r '.[0].NetworkSettings.IPAddress'"><div></div></button></div></figure></div></div></div><div class="el-p"><p dir="auto" data-rve-block="true" tabindex="-1">Or using a <a data-tooltip-position="top" aria-label="https://docs.docker.com/engine/reference/commandline/inspect" rel="noopener nofollow" class="external-link" href="https://docs.docker.com/engine/reference/commandline/inspect" target="_blank">go template</a>:</p></div><div class="el-pre"><div class="block-language-bash"><div class="expressive-code"><figure class="frame is-terminal"><figcaption class="header"><span class="title"></span><span class="sr-only">Terminal window</span></figcaption><pre data-language="bash"><code><div class="ec-line"><div class="code"><span style="color:#87FF5F">docker</span><span style="color:#BBBBBB"> </span><span style="color:#AB92FC">inspect</span><span style="color:#BBBBBB"> </span><span style="color:#8EDF5F">-f</span><span style="color:#BBBBBB"> </span><span style="color:#AB92FC">'{{ .NetworkSettings.IPAddress }}'</span><span style="color:#BBBBBB"> </span><span style="color:#AB92FC">&lt;container_name&gt;</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="docker inspect -f '{{ .NetworkSettings.IPAddress }}' <container_name>"><div></div></button></div></figure></div></div></div><div class="el-p"><p dir="auto" data-rve-block="true" tabindex="-1">Or when building an image from Dockerfile, when you want to pass in a build argument:</p></div><div class="el-pre"><div class="block-language-bash"><div class="expressive-code"><figure class="frame is-terminal"><figcaption class="header"><span class="title"></span><span class="sr-only">Terminal window</span></figcaption><pre data-language="bash"><code><div class="ec-line"><div class="code"><span style="color:#E1D6F8">DOCKER_HOST_IP</span><span style="color:#B968FC">=</span><span style="color:#AB92FC">`</span><span style="color:#87FF5F">ifconfig</span><span style="color:#AB92FC"> </span><span style="color:#B968FC">|</span><span style="color:#AB92FC"> </span><span style="color:#87FF5F">grep</span><span style="color:#AB92FC"> </span><span style="color:#8EDF5F">-E</span><span style="color:#AB92FC"> "([0-9]{1,3}\.){3}[0-9]{1,3}" </span><span style="color:#B968FC">|</span><span style="color:#AB92FC"> </span><span style="color:#87FF5F">grep</span><span style="color:#AB92FC"> </span><span style="color:#8EDF5F">-v</span><span style="color:#AB92FC"> </span><span style="color:#87FF5F">127.0.0.1</span><span style="color:#AB92FC"> </span><span style="color:#B968FC">|</span><span style="color:#AB92FC"> </span><span style="color:#87FF5F">awk</span><span style="color:#AB92FC"> '{ print $2 }' </span><span style="color:#B968FC">|</span><span style="color:#AB92FC"> </span><span style="color:#87FF5F">cut</span><span style="color:#AB92FC"> </span><span style="color:#8EDF5F">-f2</span><span style="color:#AB92FC"> </span><span style="color:#8EDF5F">-d:</span><span style="color:#AB92FC"> </span><span style="color:#B968FC">|</span><span style="color:#AB92FC"> </span><span style="color:#87FF5F">head</span><span style="color:#AB92FC"> </span><span style="color:#8EDF5F">-n1</span><span style="color:#AB92FC">`</span></div></div><div class="ec-line"><div class="code"><span style="color:#87FF5F">echo</span><span style="color:#BBBBBB"> </span><span style="color:#AB92FC">DOCKER_HOST_IP</span><span style="color:#BBBBBB"> </span><span style="color:#AB92FC">=</span><span style="color:#BBBBBB"> </span><span style="color:#E1D6F8">$DOCKER_HOST_IP</span></div></div><div class="ec-line"><div class="code"><span style="color:#87FF5F">docker</span><span style="color:#BBBBBB"> </span><span style="color:#AB92FC">build</span><span style="color:#BBBBBB"> </span><span style="color:#8EDF5F">\</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="color:#8EDF5F">--build-arg</span><span style="color:#BBBBBB"> </span><span style="color:#AB92FC">ARTIFACTORY_ADDRESS=</span><span style="color:#E1D6F8">$DOCKER_HOST_IP</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="color:#87FF5F">-t</span><span style="color:#BBBBBB"> </span><span style="color:#AB92FC">sometag</span><span style="color:#BBBBBB"> </span><span style="color:#8EDF5F">\</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="color:#AB92FC">some-directory/</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="DOCKER_HOST_IP=`ifconfig | grep -E &quot;([0-9]{1,3}\.){3}[0-9]{1,3}&quot; | grep -v 127.0.0.1 | awk '{ print $2 }' | cut -f2 -d: | head -n1`echo DOCKER_HOST_IP = $DOCKER_HOST_IPdocker build \  --build-arg ARTIFACTORY_ADDRESS=$DOCKER_HOST_IP  -t sometag \  some-directory/"><div></div></button></div></figure></div></div></div><div class="el-h3"><a name="get-port-mapping"></a><br><h3 data-heading="Get port mapping" dir="auto" data-rve-block="true" tabindex="-1"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>Get port mapping</h3></div><div class="el-pre"><div class="block-language-bash"><div class="expressive-code"><figure class="frame is-terminal"><figcaption class="header"><span class="title"></span><span class="sr-only">Terminal window</span></figcaption><pre data-language="bash"><code><div class="ec-line"><div class="code"><span style="color:#87FF5F">docker</span><span style="color:#BBBBBB"> </span><span style="color:#AB92FC">inspect</span><span style="color:#BBBBBB"> </span><span style="color:#8EDF5F">-f</span><span style="color:#BBBBBB"> </span><span style="color:#AB92FC">'{{range $p, $conf := .NetworkSettings.Ports}} {{$p}} -&gt; {{(index $conf 0).HostPort}} {{end}}'</span><span style="color:#BBBBBB"> </span><span style="color:#AB92FC">&lt;containername&gt;</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="docker inspect -f '{{range $p, $conf := .NetworkSettings.Ports}} {{$p}} -> {{(index $conf 0).HostPort}} {{end}}' <containername>"><div></div></button></div></figure></div></div></div><div class="el-h3"><a name="find-containers-by-regular-expression"></a><br><h3 data-heading="Find containers by regular expression" dir="auto" data-rve-block="true" tabindex="-1"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>Find containers by regular expression</h3></div><div class="el-pre"><div class="block-language-bash"><div class="expressive-code"><figure class="frame is-terminal"><figcaption class="header"><span class="title"></span><span class="sr-only">Terminal window</span></figcaption><pre data-language="bash"><code><div class="ec-line"><div class="code"><span style="color:#B968FC">for</span><span style="color:#BBBBBB"> </span><span style="color:#E1D6F8">i</span><span style="color:#BBBBBB"> </span><span style="color:#B968FC">in</span><span style="color:#BBBBBB"> $(</span><span style="color:#87FF5F">docker</span><span style="color:#BBBBBB"> </span><span style="color:#AB92FC">ps</span><span style="color:#BBBBBB"> </span><span style="color:#8EDF5F">-a</span><span style="color:#BBBBBB"> </span><span style="color:#B968FC">|</span><span style="color:#BBBBBB"> </span><span style="color:#87FF5F">grep</span><span style="color:#BBBBBB"> </span><span style="color:#AB92FC">"REGEXP_PATTERN"</span><span style="color:#BBBBBB"> </span><span style="color:#B968FC">|</span><span style="color:#BBBBBB"> </span><span style="color:#87FF5F">cut</span><span style="color:#BBBBBB"> </span><span style="color:#8EDF5F">-f1</span><span style="color:#BBBBBB"> </span><span style="color:#8EDF5F">-d</span><span style="color:#AB92FC">" "</span><span style="color:#BBBBBB">); </span><span style="color:#B968FC">do</span><span style="color:#BBBBBB"> </span><span style="color:#87FF5F">echo</span><span style="color:#BBBBBB"> </span><span style="color:#E1D6F8">$i</span><span style="color:#BBBBBB">; </span><span style="color:#B968FC">done</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="for i in $(docker ps -a | grep &quot;REGEXP_PATTERN&quot; | cut -f1 -d&quot; &quot;); do echo $i; done"><div></div></button></div></figure></div></div></div><div class="el-h3"><a name="get-environment-settings"></a><br><h3 data-heading="Get Environment Settings" dir="auto" data-rve-block="true" tabindex="-1"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>Get Environment Settings</h3></div><div class="el-pre"><div class="block-language-bash"><div class="expressive-code"><figure class="frame is-terminal"><figcaption class="header"><span class="title"></span><span class="sr-only">Terminal window</span></figcaption><pre data-language="bash"><code><div class="ec-line"><div class="code"><span style="color:#87FF5F">docker</span><span style="color:#BBBBBB"> </span><span style="color:#AB92FC">run</span><span style="color:#BBBBBB"> </span><span style="color:#8EDF5F">--rm</span><span style="color:#BBBBBB"> </span><span style="color:#AB92FC">ubuntu</span><span style="color:#BBBBBB"> </span><span style="color:#AB92FC">env</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="docker run --rm ubuntu env"><div></div></button></div></figure></div></div></div><div class="el-h3"><a name="kill-running-containers"></a><br><h3 data-heading="Kill running containers" dir="auto" data-rve-block="true" tabindex="-1"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>Kill running containers</h3></div><div class="el-pre"><div class="block-language-bash"><div class="expressive-code"><figure class="frame is-terminal"><figcaption class="header"><span class="title"></span><span class="sr-only">Terminal window</span></figcaption><pre data-language="bash"><code><div class="ec-line"><div class="code"><span style="color:#87FF5F">docker</span><span style="color:#BBBBBB"> </span><span style="color:#AB92FC">kill</span><span style="color:#BBBBBB"> $(</span><span style="color:#87FF5F">docker</span><span style="color:#BBBBBB"> </span><span style="color:#AB92FC">ps</span><span style="color:#BBBBBB"> </span><span style="color:#8EDF5F">-q</span><span style="color:#BBBBBB">)</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="docker kill $(docker ps -q)"><div></div></button></div></figure></div></div></div><div class="el-h3"><a name="delete-all-containers-force-running-or-stopped-containers-"></a><br><h3 data-heading="Delete all containers (force!! running or stopped containers)" dir="auto" data-rve-block="true" tabindex="-1"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>Delete all containers (force!! running or stopped containers)</h3></div><div class="el-pre"><div class="block-language-bash"><div class="expressive-code"><figure class="frame is-terminal"><figcaption class="header"><span class="title"></span><span class="sr-only">Terminal window</span></figcaption><pre data-language="bash"><code><div class="ec-line"><div class="code"><span style="color:#87FF5F">docker</span><span style="color:#BBBBBB"> </span><span style="color:#AB92FC">rm</span><span style="color:#BBBBBB"> </span><span style="color:#8EDF5F">-f</span><span style="color:#BBBBBB"> $(</span><span style="color:#87FF5F">docker</span><span style="color:#BBBBBB"> </span><span style="color:#AB92FC">ps</span><span style="color:#BBBBBB"> </span><span style="color:#8EDF5F">-qa</span><span style="color:#BBBBBB">)</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="docker rm -f $(docker ps -qa)"><div></div></button></div></figure></div></div></div><div class="el-h3"><a name="delete-old-containers"></a><br><h3 data-heading="Delete old containers" dir="auto" data-rve-block="true" tabindex="-1"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>Delete old containers</h3></div><div class="el-pre"><div class="block-language-bash"><div class="expressive-code"><figure class="frame is-terminal"><figcaption class="header"><span class="title"></span><span class="sr-only">Terminal window</span></figcaption><pre data-language="bash"><code><div class="ec-line"><div class="code"><span style="color:#87FF5F">docker</span><span style="color:#BBBBBB"> </span><span style="color:#AB92FC">ps</span><span style="color:#BBBBBB"> </span><span style="color:#8EDF5F">-a</span><span style="color:#BBBBBB"> </span><span style="color:#B968FC">|</span><span style="color:#BBBBBB"> </span><span style="color:#87FF5F">grep</span><span style="color:#BBBBBB"> </span><span style="color:#AB92FC">'weeks ago'</span><span style="color:#BBBBBB"> </span><span style="color:#B968FC">|</span><span style="color:#BBBBBB"> </span><span style="color:#87FF5F">awk</span><span style="color:#BBBBBB"> </span><span style="color:#AB92FC">'{print $1}'</span><span style="color:#BBBBBB"> </span><span style="color:#B968FC">|</span><span style="color:#BBBBBB"> </span><span style="color:#87FF5F">xargs</span><span style="color:#BBBBBB"> </span><span style="color:#AB92FC">docker</span><span style="color:#BBBBBB"> </span><span style="color:#AB92FC">rm</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="docker ps -a | grep 'weeks ago' | awk '{print $1}' | xargs docker rm"><div></div></button></div></figure></div></div></div><div class="el-h3"><a name="delete-stopped-containers"></a><br><h3 data-heading="Delete stopped containers" dir="auto" data-rve-block="true" tabindex="-1"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>Delete stopped containers</h3></div><div class="el-pre"><div class="block-language-bash"><div class="expressive-code"><figure class="frame is-terminal"><figcaption class="header"><span class="title"></span><span class="sr-only">Terminal window</span></figcaption><pre data-language="bash"><code><div class="ec-line"><div class="code"><span style="color:#87FF5F">docker</span><span style="color:#BBBBBB"> </span><span style="color:#AB92FC">rm</span><span style="color:#BBBBBB"> </span><span style="color:#8EDF5F">-v</span><span style="color:#BBBBBB"> $(</span><span style="color:#87FF5F">docker</span><span style="color:#BBBBBB"> </span><span style="color:#AB92FC">ps</span><span style="color:#BBBBBB"> </span><span style="color:#8EDF5F">-a</span><span style="color:#BBBBBB"> </span><span style="color:#8EDF5F">-q</span><span style="color:#BBBBBB"> </span><span style="color:#8EDF5F">-f</span><span style="color:#BBBBBB"> </span><span style="color:#AB92FC">status=exited</span><span style="color:#BBBBBB">)</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="docker rm -v $(docker ps -a -q -f status=exited)"><div></div></button></div></figure></div></div></div><div class="el-h3"><a name="delete-containers-after-stopping"></a><br><h3 data-heading="Delete containers after stopping" dir="auto" data-rve-block="true" tabindex="-1"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>Delete containers after stopping</h3></div><div class="el-pre"><div class="block-language-bash"><div class="expressive-code"><figure class="frame is-terminal"><figcaption class="header"><span class="title"></span><span class="sr-only">Terminal window</span></figcaption><pre data-language="bash"><code><div class="ec-line"><div class="code"><span style="color:#87FF5F">docker</span><span style="color:#BBBBBB"> </span><span style="color:#AB92FC">stop</span><span style="color:#BBBBBB"> $(</span><span style="color:#87FF5F">docker</span><span style="color:#BBBBBB"> </span><span style="color:#AB92FC">ps</span><span style="color:#BBBBBB"> </span><span style="color:#8EDF5F">-aq</span><span style="color:#BBBBBB">) </span><span style="color:#ABB2BF">&amp;&amp;</span><span style="color:#BBBBBB"> </span><span style="color:#87FF5F">docker</span><span style="color:#BBBBBB"> </span><span style="color:#AB92FC">rm</span><span style="color:#BBBBBB"> </span><span style="color:#8EDF5F">-v</span><span style="color:#BBBBBB"> $(</span><span style="color:#87FF5F">docker</span><span style="color:#BBBBBB"> </span><span style="color:#AB92FC">ps</span><span style="color:#BBBBBB"> </span><span style="color:#8EDF5F">-aq</span><span style="color:#BBBBBB">)</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="docker stop $(docker ps -aq) &amp;&amp; docker rm -v $(docker ps -aq)"><div></div></button></div></figure></div></div></div><div class="el-h3"><a name="delete-dangling-images"></a><br><h3 data-heading="Delete dangling images" dir="auto" data-rve-block="true" tabindex="-1"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>Delete dangling images</h3></div><div class="el-pre"><div class="block-language-bash"><div class="expressive-code"><figure class="frame is-terminal"><figcaption class="header"><span class="title"></span><span class="sr-only">Terminal window</span></figcaption><pre data-language="bash"><code><div class="ec-line"><div class="code"><span style="color:#87FF5F">docker</span><span style="color:#BBBBBB"> </span><span style="color:#AB92FC">rmi</span><span style="color:#BBBBBB"> $(</span><span style="color:#87FF5F">docker</span><span style="color:#BBBBBB"> </span><span style="color:#AB92FC">images</span><span style="color:#BBBBBB"> </span><span style="color:#8EDF5F">-q</span><span style="color:#BBBBBB"> </span><span style="color:#8EDF5F">-f</span><span style="color:#BBBBBB"> </span><span style="color:#AB92FC">dangling=</span><span style="color:#9CDA7C">true</span><span style="color:#BBBBBB">)</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="docker rmi $(docker images -q -f dangling=true)"><div></div></button></div></figure></div></div></div><div class="el-h3"><a name="delete-all-images"></a><br><h3 data-heading="Delete all images" dir="auto" data-rve-block="true" tabindex="-1"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>Delete all images</h3></div><div class="el-pre"><div class="block-language-bash"><div class="expressive-code"><figure class="frame is-terminal"><figcaption class="header"><span class="title"></span><span class="sr-only">Terminal window</span></figcaption><pre data-language="bash"><code><div class="ec-line"><div class="code"><span style="color:#87FF5F">docker</span><span style="color:#BBBBBB"> </span><span style="color:#AB92FC">rmi</span><span style="color:#BBBBBB"> $(</span><span style="color:#87FF5F">docker</span><span style="color:#BBBBBB"> </span><span style="color:#AB92FC">images</span><span style="color:#BBBBBB"> </span><span style="color:#8EDF5F">-q</span><span style="color:#BBBBBB">)</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="docker rmi $(docker images -q)"><div></div></button></div></figure></div></div></div><div class="el-h3"><a name="delete-dangling-volumes"></a><br><h3 data-heading="Delete dangling volumes" dir="auto" data-rve-block="true" tabindex="-1"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>Delete dangling volumes</h3></div><div class="el-p"><p dir="auto" data-rve-block="true" tabindex="-1">As of Docker 1.9:</p></div><div class="el-pre"><div class="block-language-bash"><div class="expressive-code"><figure class="frame is-terminal"><figcaption class="header"><span class="title"></span><span class="sr-only">Terminal window</span></figcaption><pre data-language="bash"><code><div class="ec-line"><div class="code"><span style="color:#87FF5F">docker</span><span style="color:#BBBBBB"> </span><span style="color:#AB92FC">volume</span><span style="color:#BBBBBB"> </span><span style="color:#AB92FC">rm</span><span style="color:#BBBBBB"> $(</span><span style="color:#87FF5F">docker</span><span style="color:#BBBBBB"> </span><span style="color:#AB92FC">volume</span><span style="color:#BBBBBB"> </span><span style="color:#AB92FC">ls</span><span style="color:#BBBBBB"> </span><span style="color:#8EDF5F">-q</span><span style="color:#BBBBBB"> </span><span style="color:#8EDF5F">-f</span><span style="color:#BBBBBB"> </span><span style="color:#AB92FC">dangling=</span><span style="color:#9CDA7C">true</span><span style="color:#BBBBBB">)</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="docker volume rm $(docker volume ls -q -f dangling=true)"><div></div></button></div></figure></div></div></div><div class="el-p"><p dir="auto" data-rve-block="true" tabindex="-1">In 1.9.0, the filter <code>dangling=false</code> does <em>not</em> work - it is ignored and will list all volumes.</p></div><div class="el-h3"><a name="show-image-dependencies"></a><br><h3 data-heading="Show image dependencies" dir="auto" data-rve-block="true" tabindex="-1"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>Show image dependencies</h3></div><div class="el-pre"><div class="block-language-bash"><div class="expressive-code"><figure class="frame is-terminal"><figcaption class="header"><span class="title"></span><span class="sr-only">Terminal window</span></figcaption><pre data-language="bash"><code><div class="ec-line"><div class="code"><span style="color:#87FF5F">docker</span><span style="color:#BBBBBB"> </span><span style="color:#AB92FC">images</span><span style="color:#BBBBBB"> </span><span style="color:#8EDF5F">-viz</span><span style="color:#BBBBBB"> </span><span style="color:#B968FC">|</span><span style="color:#BBBBBB"> </span><span style="color:#87FF5F">dot</span><span style="color:#BBBBBB"> </span><span style="color:#8EDF5F">-Tpng</span><span style="color:#BBBBBB"> </span><span style="color:#8EDF5F">-o</span><span style="color:#BBBBBB"> </span><span style="color:#AB92FC">docker.png</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="docker images -viz | dot -Tpng -o docker.png"><div></div></button></div></figure></div></div></div><div class="el-h3"><a name="slimming-down-docker-containers"></a><br><h3 data-heading="Slimming down Docker containers" dir="auto" data-rve-block="true" tabindex="-1"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>Slimming down Docker containers</h3></div><div class="el-ul"><ul class="has-list-bullet">
<li data-line="0" dir="auto" data-rve-block="true" tabindex="-1"><span class="list-bullet"></span>Cleaning APT in a <code>RUN</code> layer - This should be done in the same layer as other <code>apt</code> commands. Otherwise, the previous layers still persist the original information and your images will still be fat.
<div class="block-language-dockerfile"><div class="expressive-code"><figure class="frame"><figcaption class="header"></figcaption><pre data-language="dockerfile"><code><div class="ec-line"><div class="code"><span style="color:#B968FC">RUN</span><span style="color:#BBBBBB"> {apt commands} \</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="color:#BBBBBB">  </span></span><span style="color:#BBBBBB">&amp;&amp; apt-get clean \</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="color:#BBBBBB">  </span></span><span style="color:#BBBBBB">&amp;&amp; rm -rf /var/lib/apt/lists/* /tmp/* /var/tmp/*</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="RUN {apt commands} \  &amp;&amp; apt-get clean \  &amp;&amp; rm -rf /var/lib/apt/lists/* /tmp/* /var/tmp/*"><div></div></button></div></figure></div></div>
</li>
<li data-line="6" dir="auto" data-rve-block="true" tabindex="-1"><span class="list-bullet"></span>Flatten an image
<div class="block-language-bash"><div class="expressive-code"><figure class="frame is-terminal"><figcaption class="header"><span class="title"></span><span class="sr-only">Terminal window</span></figcaption><pre data-language="bash"><code><div class="ec-line"><div class="code"><span style="color:#E1D6F8">ID</span><span style="color:#B968FC">=</span><span style="color:#BBBBBB">$(</span><span style="color:#87FF5F">docker</span><span style="color:#BBBBBB"> </span><span style="color:#AB92FC">run</span><span style="color:#BBBBBB"> </span><span style="color:#8EDF5F">-d</span><span style="color:#BBBBBB"> </span><span style="color:#AB92FC">image-name</span><span style="color:#BBBBBB"> </span><span style="color:#AB92FC">/bin/bash</span><span style="color:#BBBBBB">)</span></div></div><div class="ec-line"><div class="code"><span style="color:#87FF5F">docker</span><span style="color:#BBBBBB"> </span><span style="color:#AB92FC">export</span><span style="color:#BBBBBB"> </span><span style="color:#E1D6F8">$ID</span><span style="color:#BBBBBB"> </span><span style="color:#B968FC">|</span><span style="color:#BBBBBB"> </span><span style="color:#87FF5F">docker</span><span style="color:#BBBBBB"> </span><span style="color:#AB92FC">import</span><span style="color:#BBBBBB"> </span><span style="color:#AB92FC">‚Äì</span><span style="color:#BBBBBB"> </span><span style="color:#AB92FC">flat-image-name</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="ID=$(docker run -d image-name /bin/bash)docker export $ID | docker import ‚Äì flat-image-name"><div></div></button></div></figure></div></div>
</li>
<li data-line="11" dir="auto" data-rve-block="true" tabindex="-1"><span class="list-bullet"></span>For backup
<div class="block-language-bash"><div class="expressive-code"><figure class="frame is-terminal"><figcaption class="header"><span class="title"></span><span class="sr-only">Terminal window</span></figcaption><pre data-language="bash"><code><div class="ec-line"><div class="code"><span style="color:#E1D6F8">ID</span><span style="color:#B968FC">=</span><span style="color:#BBBBBB">$(</span><span style="color:#87FF5F">docker</span><span style="color:#BBBBBB"> </span><span style="color:#AB92FC">run</span><span style="color:#BBBBBB"> </span><span style="color:#8EDF5F">-d</span><span style="color:#BBBBBB"> </span><span style="color:#AB92FC">image-name</span><span style="color:#BBBBBB"> </span><span style="color:#AB92FC">/bin/bash</span><span style="color:#BBBBBB">)</span></div></div><div class="ec-line"><div class="code"><span style="color:#BBBBBB">(</span><span style="color:#87FF5F">docker</span><span style="color:#BBBBBB"> </span><span style="color:#AB92FC">export</span><span style="color:#BBBBBB"> </span><span style="color:#E1D6F8">$ID</span><span style="color:#BBBBBB"> </span><span style="color:#B968FC">|</span><span style="color:#BBBBBB"> </span><span style="color:#87FF5F">gzip</span><span style="color:#BBBBBB"> </span><span style="color:#8EDF5F">-c</span><span style="color:#BBBBBB"> </span><span style="color:#B968FC">&gt;</span><span style="color:#BBBBBB"> </span><span style="color:#AB92FC">image.tgz</span><span style="color:#BBBBBB">)</span></div></div><div class="ec-line"><div class="code"><span style="color:#87FF5F">gzip</span><span style="color:#BBBBBB"> </span><span style="color:#8EDF5F">-dc</span><span style="color:#BBBBBB"> </span><span style="color:#AB92FC">image.tgz</span><span style="color:#BBBBBB"> </span><span style="color:#B968FC">|</span><span style="color:#BBBBBB"> </span><span style="color:#87FF5F">docker</span><span style="color:#BBBBBB"> </span><span style="color:#AB92FC">import</span><span style="color:#BBBBBB"> </span><span style="color:#AB92FC">-</span><span style="color:#BBBBBB"> </span><span style="color:#AB92FC">flat-image-name</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="ID=$(docker run -d image-name /bin/bash)(docker export $ID | gzip -c > image.tgz)gzip -dc image.tgz | docker import - flat-image-name"><div></div></button></div></figure></div></div>
</li>
</ul></div><div class="el-h3"><a name="monitor-system-resource-utilization-for-running-containers"></a><br><h3 data-heading="Monitor system resource utilization for running containers" dir="auto" data-rve-block="true" tabindex="-1"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>Monitor system resource utilization for running containers</h3></div><div class="el-p"><p dir="auto" data-rve-block="true" tabindex="-1">To check the CPU, memory, and network I/O usage of a single container, you can use:</p></div><div class="el-pre"><div class="block-language-bash"><div class="expressive-code"><figure class="frame is-terminal"><figcaption class="header"><span class="title"></span><span class="sr-only">Terminal window</span></figcaption><pre data-language="bash"><code><div class="ec-line"><div class="code"><span style="color:#87FF5F">docker</span><span style="color:#BBBBBB"> </span><span style="color:#AB92FC">stats</span><span style="color:#BBBBBB"> </span><span style="color:#AB92FC">&lt;container&gt;</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="docker stats <container>"><div></div></button></div></figure></div></div></div><div class="el-h3"><a name="for-all-containers-listed-by-id-"></a><br><h3 data-heading="For all containers listed by ID:" dir="auto" data-rve-block="true" tabindex="-1"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>For all containers listed by ID:</h3></div><div class="el-pre"><div class="block-language-bash"><div class="expressive-code"><figure class="frame is-terminal"><figcaption class="header"><span class="title"></span><span class="sr-only">Terminal window</span></figcaption><pre data-language="bash"><code><div class="ec-line"><div class="code"><span style="color:#87FF5F">docker</span><span style="color:#BBBBBB"> </span><span style="color:#AB92FC">stats</span><span style="color:#BBBBBB"> $(</span><span style="color:#87FF5F">docker</span><span style="color:#BBBBBB"> </span><span style="color:#AB92FC">ps</span><span style="color:#BBBBBB"> </span><span style="color:#8EDF5F">-q</span><span style="color:#BBBBBB">)</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="docker stats $(docker ps -q)"><div></div></button></div></figure></div></div></div><div class="el-h3"><a name="for-all-containers-listed-by-name-"></a><br><h3 data-heading="For all containers listed by name:" dir="auto" data-rve-block="true" tabindex="-1"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>For all containers listed by name:</h3></div><div class="el-pre"><div class="block-language-bash"><div class="expressive-code"><figure class="frame is-terminal"><figcaption class="header"><span class="title"></span><span class="sr-only">Terminal window</span></figcaption><pre data-language="bash"><code><div class="ec-line"><div class="code"><span style="color:#87FF5F">docker</span><span style="color:#BBBBBB"> </span><span style="color:#AB92FC">stats</span><span style="color:#BBBBBB"> $(</span><span style="color:#87FF5F">docker</span><span style="color:#BBBBBB"> </span><span style="color:#AB92FC">ps</span><span style="color:#BBBBBB"> </span><span style="color:#8EDF5F">--format</span><span style="color:#BBBBBB"> </span><span style="color:#AB92FC">'{{.Names}}'</span><span style="color:#BBBBBB">)</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="docker stats $(docker ps --format '{{.Names}}')"><div></div></button></div></figure></div></div></div><div class="el-h3"><a name="for-all-containers-listed-by-image-"></a><br><h3 data-heading="For all containers listed by image:" dir="auto" data-rve-block="true" tabindex="-1"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>For all containers listed by image:</h3></div><div class="el-pre"><div class="block-language-bash"><div class="expressive-code"><figure class="frame is-terminal"><figcaption class="header"><span class="title"></span><span class="sr-only">Terminal window</span></figcaption><pre data-language="bash"><code><div class="ec-line"><div class="code"><span style="color:#87FF5F">docker</span><span style="color:#BBBBBB"> </span><span style="color:#AB92FC">ps</span><span style="color:#BBBBBB"> </span><span style="color:#8EDF5F">-a</span><span style="color:#BBBBBB"> </span><span style="color:#8EDF5F">-f</span><span style="color:#BBBBBB"> </span><span style="color:#AB92FC">ancestor=ubuntu</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="docker ps -a -f ancestor=ubuntu"><div></div></button></div></figure></div></div></div><div class="el-h3"><a name="remove-all-untagged-images-"></a><br><h3 data-heading="Remove all untagged images:" dir="auto" data-rve-block="true" tabindex="-1"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>Remove all untagged images:</h3></div><div class="el-pre"><div class="block-language-bash"><div class="expressive-code"><figure class="frame is-terminal"><figcaption class="header"><span class="title"></span><span class="sr-only">Terminal window</span></figcaption><pre data-language="bash"><code><div class="ec-line"><div class="code"><span style="color:#87FF5F">docker</span><span style="color:#BBBBBB"> </span><span style="color:#AB92FC">rmi</span><span style="color:#BBBBBB"> $(</span><span style="color:#87FF5F">docker</span><span style="color:#BBBBBB"> </span><span style="color:#AB92FC">images</span><span style="color:#BBBBBB"> </span><span style="color:#B968FC">|</span><span style="color:#BBBBBB"> </span><span style="color:#87FF5F">grep</span><span style="color:#BBBBBB"> </span><span style="color:#AB92FC">‚Äú^‚Äù</span><span style="color:#BBBBBB"> </span><span style="color:#B968FC">|</span><span style="color:#BBBBBB"> </span><span style="color:#87FF5F">awk</span><span style="color:#BBBBBB"> </span><span style="color:#AB92FC">'{split($0,a," "); print a[3]}'</span><span style="color:#BBBBBB">)</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="docker rmi $(docker images | grep ‚Äú^‚Äù | awk '{split($0,a,&quot; &quot;); print a[3]}')"><div></div></button></div></figure></div></div></div><div class="el-h3"><a name="remove-container-by-a-regular-expression-"></a><br><h3 data-heading="Remove container by a regular expression:" dir="auto" data-rve-block="true" tabindex="-1"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>Remove container by a regular expression:</h3></div><div class="el-pre"><div class="block-language-bash"><div class="expressive-code"><figure class="frame is-terminal"><figcaption class="header"><span class="title"></span><span class="sr-only">Terminal window</span></figcaption><pre data-language="bash"><code><div class="ec-line"><div class="code"><span style="color:#87FF5F">docker</span><span style="color:#BBBBBB"> </span><span style="color:#AB92FC">ps</span><span style="color:#BBBBBB"> </span><span style="color:#8EDF5F">-a</span><span style="color:#BBBBBB"> </span><span style="color:#B968FC">|</span><span style="color:#BBBBBB"> </span><span style="color:#87FF5F">grep</span><span style="color:#BBBBBB"> </span><span style="color:#AB92FC">wildfly</span><span style="color:#BBBBBB"> </span><span style="color:#B968FC">|</span><span style="color:#BBBBBB"> </span><span style="color:#87FF5F">awk</span><span style="color:#BBBBBB"> </span><span style="color:#AB92FC">'{print $1}'</span><span style="color:#BBBBBB"> </span><span style="color:#B968FC">|</span><span style="color:#BBBBBB"> </span><span style="color:#87FF5F">xargs</span><span style="color:#BBBBBB"> </span><span style="color:#AB92FC">docker</span><span style="color:#BBBBBB"> </span><span style="color:#AB92FC">rm</span><span style="color:#BBBBBB"> </span><span style="color:#8EDF5F">-f</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="docker ps -a | grep wildfly | awk '{print $1}' | xargs docker rm -f"><div></div></button></div></figure></div></div></div><div class="el-h3"><a name="remove-all-exited-containers-"></a><br><h3 data-heading="Remove all exited containers:" dir="auto" data-rve-block="true" tabindex="-1"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>Remove all exited containers:</h3></div><div class="el-pre"><div class="block-language-bash"><div class="expressive-code"><figure class="frame is-terminal"><figcaption class="header"><span class="title"></span><span class="sr-only">Terminal window</span></figcaption><pre data-language="bash"><code><div class="ec-line"><div class="code"><span style="color:#87FF5F">docker</span><span style="color:#BBBBBB"> </span><span style="color:#AB92FC">rm</span><span style="color:#BBBBBB"> </span><span style="color:#8EDF5F">-f</span><span style="color:#BBBBBB"> $(</span><span style="color:#87FF5F">docker</span><span style="color:#BBBBBB"> </span><span style="color:#AB92FC">ps</span><span style="color:#BBBBBB"> </span><span style="color:#8EDF5F">-a</span><span style="color:#BBBBBB"> </span><span style="color:#B968FC">|</span><span style="color:#BBBBBB"> </span><span style="color:#87FF5F">grep</span><span style="color:#BBBBBB"> </span><span style="color:#AB92FC">Exit</span><span style="color:#BBBBBB"> </span><span style="color:#B968FC">|</span><span style="color:#BBBBBB"> </span><span style="color:#87FF5F">awk</span><span style="color:#BBBBBB"> </span><span style="color:#AB92FC">'{ print $1 }'</span><span style="color:#BBBBBB">)</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="docker rm -f $(docker ps -a | grep Exit | awk '{ print $1 }')"><div></div></button></div></figure></div></div></div><div class="el-h3"><a name="volumes-can-be-files"></a><br><h3 data-heading="Volumes can be files" dir="auto" data-rve-block="true" tabindex="-1"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>Volumes can be files</h3></div><div class="el-p"><p dir="auto" data-rve-block="true" tabindex="-1">Be aware that you can mount files as volumes. For example you can inject a configuration file like this:</p></div><div class="el-pre"><div class="block-language-bash"><div class="expressive-code"><figure class="frame is-terminal"><figcaption class="header"><span class="title"></span><span class="sr-only">Terminal window</span></figcaption><pre data-language="bash"><code><div class="ec-line"><div class="code"><span style="color:#A1A0AD"># copy file from container</span></div></div><div class="ec-line"><div class="code"><span style="color:#87FF5F">docker</span><span style="color:#BBBBBB"> </span><span style="color:#AB92FC">run</span><span style="color:#BBBBBB"> </span><span style="color:#8EDF5F">--rm</span><span style="color:#BBBBBB"> </span><span style="color:#AB92FC">httpd</span><span style="color:#BBBBBB"> </span><span style="color:#AB92FC">cat</span><span style="color:#BBBBBB"> </span><span style="color:#AB92FC">/usr/local/apache2/conf/httpd.conf</span><span style="color:#BBBBBB"> </span><span style="color:#B968FC">&gt;</span><span style="color:#BBBBBB"> </span><span style="color:#AB92FC">httpd.conf</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="color:#A1A0AD"># edit file</span></div></div><div class="ec-line"><div class="code"><span style="color:#87FF5F">vim</span><span style="color:#BBBBBB"> </span><span style="color:#AB92FC">httpd.conf</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="color:#A1A0AD"># start container with modified configuration</span></div></div><div class="ec-line"><div class="code"><span style="color:#87FF5F">docker</span><span style="color:#BBBBBB"> </span><span style="color:#AB92FC">run</span><span style="color:#BBBBBB"> </span><span style="color:#8EDF5F">--rm</span><span style="color:#BBBBBB"> </span><span style="color:#8EDF5F">-it</span><span style="color:#BBBBBB"> </span><span style="color:#8EDF5F">-v</span><span style="color:#BBBBBB"> </span><span style="color:#AB92FC">"</span><span style="color:#E1D6F8">$PWD</span><span style="color:#AB92FC">/httpd.conf:/usr/local/apache2/conf/httpd.conf:ro"</span><span style="color:#BBBBBB"> </span><span style="color:#8EDF5F">-p</span><span style="color:#BBBBBB"> </span><span style="color:#AB92FC">"80:80"</span><span style="color:#BBBBBB"> </span><span style="color:#AB92FC">httpd</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="docker run --rm httpd cat /usr/local/apache2/conf/httpd.conf > httpd.confvim httpd.confdocker run --rm -it -v &quot;$PWD/httpd.conf:/usr/local/apache2/conf/httpd.conf:ro&quot; -p &quot;80:80&quot; httpd"><div></div></button></div></figure></div></div></div><div class="mod-footer mod-ui"></div></div></div></div>
